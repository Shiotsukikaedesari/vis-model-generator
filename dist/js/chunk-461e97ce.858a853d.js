(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-461e97ce"],{"32f8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material-container"},[a("drag-plane",{attrs:{amount:2,width:"100%",height:t.height+"px",showDragsign:!1},scopedSlots:t._u([{key:"view1",fn:function(){return[a("div",{staticClass:"box-header"},[a("el-input",{attrs:{size:"mini","prefix-icon":"el-icon-search",placeholder:"材质筛选"}}),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.addMaterial}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus-outline",type:"primary"}},[t._v(" 添加材质 ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.material,(function(e,i){return a("el-dropdown-item",{key:i,attrs:{command:e},domProps:{textContent:t._s(e.label)}})})),1)],1)],1),a("div",{staticClass:"box-container"},[a("div",{staticClass:"material-main"},t._l(t.materialList,(function(e,i){return a("div",{key:i,staticClass:"material-elem",on:{mousedown:function(){t.$store.commit("material/setCurrentMaterial",e.vid)}}},[a("div",{ref:e.vid,refInFor:!0,staticClass:"render-box",class:{active:t.currentMaterial.vid===e.vid},attrs:{draggable:"true",id:e.vid},on:{dragstart:function(a){return t.dragstart(a,e.vid)}}}),a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"删除",expression:"'删除'",modifiers:{top:!0}}],staticClass:"operate-box"},[a("vis-icon",{attrs:{code:"#iconshanchu"}})],1),a("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.vid,expression:"item.vid",modifiers:{bottom:!0}}],staticClass:"element-title",domProps:{textContent:t._s(e.vid)}})])})),0)])]},proxy:!0},{key:"view2",fn:function(){return[a("material-setting-module")]},proxy:!0}])})],1)},n=[],r=(a("a9e3"),a("d3b7"),a("159b"),a("b64b"),a("ec26")),o=a("6fab"),s=a("35bb"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"materialSettingModule-container"},[t.config?a("collapse-layout",{attrs:{label:"材质",icon:"#iconcaizhishezhi",arrowPosition:"left"},scopedSlots:t._u([{key:"container",fn:function(){return[a("vis-controller-input",{attrs:{keyframe:!1,label:"类型",disabled:""},model:{value:t.config.label,callback:function(e){t.$set(t.config,"label",e)},expression:"config.label"}})]},proxy:!0}],null,!1,2045396974)}):t._e(),a(t.type,{tag:"components",attrs:{config:t.config}})],1)},l=[],d=(a("3ca3"),a("ddb0"),a("597a")),u=function(){return a.e("chunk-40d6be3a").then(a.bind(null,"01fa"))},m=function(){return a.e("chunk-75277101").then(a.bind(null,"4e96"))},p={components:{collapseLayout:d["a"],MeshStandardMaterial:u,VisMeshPhysicalMaterial:m},computed:{config:function(){return this.$store.getters["material/currentMaterial"]},type:function(){var t;return null===(t=this.config)||void 0===t?void 0:t.type}},methods:{}},f=p,v=(a("4e9a"),a("2877")),h=Object(v["a"])(f,c,l,!1,null,"1538915e",null),g=h.exports,b=a("2209"),y={components:{dragPlane:o["a"],materialSettingModule:g},props:{height:{type:Number}},data:function(){return{material:[{icon:"#icondengpao",label:"标准网格材质",material:b["a"].MESHSTANDARDMATERIAL}],displayerMap:{},watchMap:{},timer:"",throttleTime:1e3/45,canMove:!0}},computed:{materialList:function(){return this.$store.getters["material/get"]},currentMaterial:function(){return this.$store.getters["material/currentMaterial"]}},methods:{dragstart:function(t,e){var a=this;t.preventDefault(),this.$store.commit("material/setDraggedMaterial",e);var i=t.target,n=i.getElementsByTagName("canvas");if(n.length>0){this.$store.commit("material/dragging",!0);var r=n[0],o=new Image;o.src=r.toDataURL("image/png"),o.style.position="fixed",o.style.zIndex=20,o.style.opacity=.6,document.body.appendChild(o);var s=function(t){a.canMove&&(a.canMove=!1,a.timer=setTimeout((function(){o.style.top="".concat(t.clientY+10,"px"),o.style.left="".concat(t.clientX+10,"px"),a.canMove=!0}),a.throttleTime))},c=function t(e){document.body.removeChild(o),document.body.removeEventListener("mousemove",s),document.body.removeEventListener("mouseup",t)};document.body.addEventListener("mousemove",s),document.body.addEventListener("mouseup",c)}else console.error("can not found canvas in this dom")},addMaterial:function(t){var e=Object(b["n"])(t.material,{vid:Object(r["a"])()});this.$store.commit("material/add",e),this.$store.commit("material/setCurrentMaterial",e.vid)}},watch:{materialList:function(t,e){var a=this;this.$nextTick((function(){Object.keys(t).forEach((function(t){if(!a.$refs[t])return console.error("can not found this dom: '".concat(t,"'")),!1;if(a.displayerMap[t])return!1;var e=a.$refs[t][0],i=new b["f"]({dom:e,material:s["a"].compilerManager.getMaterial(t)});e.offsetHeight||i.setSize(75,55),i.render(),a.displayerMap[t]=i,a.watchMap[t]=a.$watch((function(){return this.materialList[t]}),(function(e){a.displayerMap[t].render()}),{deep:!0})}))}))}}},M=y,w=(a("4fd8"),Object(v["a"])(M,i,n,!1,null,"32f95242",null));e["default"]=w.exports},"4e9a":function(t,e,a){"use strict";a("e851")},"4fd8":function(t,e,a){"use strict";a("b281")},b281:function(t,e,a){},e851:function(t,e,a){}}]);