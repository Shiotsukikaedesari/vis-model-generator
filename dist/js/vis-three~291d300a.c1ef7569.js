(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vis-three~291d300a"],{fe9e:function(e,t,a){"use strict";a.d(t,"a",(function(){return Oe})),a.d(t,"b",(function(){return At})),a.d(t,"c",(function(){return Ct})),a.d(t,"d",(function(){return ye})),a.d(t,"e",(function(){return Et})),a.d(t,"f",(function(){return Ca})),a.d(t,"g",(function(){return Bt})),a.d(t,"h",(function(){return ka})),a.d(t,"i",(function(){return Tt})),a.d(t,"j",(function(){return D})),a.d(t,"k",(function(){return ja})),a.d(t,"l",(function(){return jt})),a.d(t,"m",(function(){return Aa})),a.d(t,"n",(function(){return dt}));var r,n=a("ade3"),i=a("b85c"),o=a("45eb"),s=a("7e84"),c=a("257e"),l=a("262e"),u=a("2caf"),h=a("2909"),p=a("d4ec"),d=a("bee2"),f=a("53ca"),m=(a("4ec9"),a("d3b7"),a("3ca3"),a("ddb0"),a("6062"),a("159b"),a("b64b"),a("d81d"),a("a434"),a("b0c0"),a("10d1"),a("99af"),a("ac1f"),a("5319"),a("1276"),a("eee7"),a("498a"),a("00b4"),a("38cf"),a("a15b"),a("a9e3"),a("b680"),a("e9c4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("d9e2"),a("25f0"),a("5d41"),a("f8c9"),a("7ed3"),a("ac16"),a("1fe2"),a("bf19"),a("fb6a"),a("caad"),a("2532"),a("5492")),v=a("77bc"),b=a("e61b"),g=a("1dab"),O=a("63b7"),y=a("10d4"),j=Object.defineProperty,M=function(e,t,a){return t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a},E=function(e,t,a){return M(e,"symbol"!==Object(f["a"])(t)?t+"":t,a),a},w=function(){function e(){Object(p["a"])(this,e),E(this,"listeners",new Map)}return Object(d["a"])(e,[{key:"addEventListener",value:function(e,t){var a=this.listeners;a.has(e)||a.set(e,new Set),a.get(e).add(t)}},{key:"hasEventListener",value:function(e,t){var a=this.listeners;return!!a.has(e)&&a.get(e).has(t)}},{key:"removeEventListener",value:function(e,t){var a=this.listeners;a.has(e)&&a.get(e).has(t)&&a.get(e).delete(t)}},{key:"dispatchEvent",value:function(e){var t,a=this,r=e.type,n=this.listeners;if(n.has(r))try{null==(t=n.get(r))||t.forEach((function(t){t.call(a,e)}))}catch(i){console.error(i)}}},{key:"clear",value:function(){this.listeners=new Map}},{key:"useful",value:function(){return Boolean(Object(h["a"])(this.listeners.keys()).length)}}]),e}(),C="rgb(230, 20, 240)",S="rgb(255, 158, 240)",A="rgb(255, 255, 255)",L=function(){return new m["E"]({color:A})},k=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"sphere"),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"shape"),E(Object(c["a"])(r),"type","VisPointLightHelper"),E(Object(c["a"])(r),"cachaColor"),E(Object(c["a"])(r),"cachaDistance"),E(Object(c["a"])(r),"cachaVector3"),r.geometry=new m["e"];var n=[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,0,0,-.707,-.707,0,.707,.707,0,.707,-.707,0,-.707,.707,-.707,0,-.707,.707,0,.707,.707,0,-.707,-.707,0,.707];r.geometry.setAttribute("position",new m["v"](n,3)),r.material=L(),r.geometry.boundingSphere;var i=(new m["k"]).copy(e.color).multiplyScalar(e.intensity),o=new m["O"](new m["W"](e.distance,0),new m["P"]({color:i,wireframe:!0}));return o.raycast=function(){},r.shape=o,r.target=e,r.sphere=new m["nb"](new m["Cb"](0,0,0),1),r.cachaColor=e.color.getHex(),r.cachaDistance=e.distance,r.cachaVector3=new m["Cb"],r.add(r.shape),r.matrixAutoUpdate=!1,r.matrix=e.matrix,r.onBeforeRender=function(){var e=r.target,t=r.shape,a=Object(c["a"])(r);e.distance!==r.cachaDistance&&(t.geometry.dispose(),t.geometry=new m["W"](e.distance,0),r.cachaDistance=e.distance),e.color.getHex()!==r.cachaColor&&(t.material.color.copy(e.color).multiplyScalar(e.intensity),a.material.color.copy(e.color).multiplyScalar(e.intensity),r.cachaColor=e.color.getHex())},r}return Object(d["a"])(a,[{key:"raycast",value:function(e,t){var a=this.target,r=a.matrixWorld,n=this.sphere;n.set(this.cachaVector3.set(0,0,0),1),n.applyMatrix4(r),e.ray.intersectsSphere(n)&&t.push({distance:e.ray.origin.distanceTo(a.position),object:a,point:a.position})}}]),a}(m["F"]),R=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"shape"),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"type","CameraHelper"),E(Object(c["a"])(r),"cachaData");var n=new m["e"],i=[0,0,0,-1,1,-1,0,0,0,-1,1,1,0,0,0,-1,-1,-1,0,0,0,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,-1,1,0,0,0,0,1,1,0,0,0,0,1,-1,0,0,0,0,-1,-1,0,0,0,0,-1,1,0,1,1,0,1,-1,0,1,-1,0,-1,-1,0,-1,-1,0,-1,1,0,-1,1,0,1,1,0,-1,1,2,-1,1,0,1,-1,2,1,-1,0,-1,-1,2,-1,-1,0,1,1,2,1,1,2,1,1,2,-1,1,2,-1,1,2,-1,-1,2,-1,-1,2,1,-1,2,1,-1,2,1,1];n.setAttribute("position",new m["v"](i,3)),n.rotateY(-90*Math.PI/180),n.computeBoundingBox();var o=new m["g"](e);return o.matrix=new m["N"],o.matrixAutoUpdate=!0,o.raycast=function(){},r.add(o),r.shape=o,r.geometry=n,r.material=L(),r.target=e,r.matrixAutoUpdate=!1,r.matrix=e.matrix,e instanceof m["bb"]?r.cachaData={fov:e.fov,aspect:e.aspect,near:e.near,far:e.far}:e instanceof m["Y"]?r.cachaData={left:e.left,right:e.right,top:e.top,bottom:e.bottom,near:e.near,far:e.far}:r.cachaData={},r.onBeforeRender=function(){var t=!1,a=r.cachaData;Object.keys(a).forEach((function(r){a[r]!==e[r]&&(a[r]=e[r],t=!0)})),t&&r.shape.update()},r}return Object(d["a"])(a,[{key:"raycast",value:function(e,t){var a=this.matrixWorld,r=this.geometry.boundingBox.clone();if(r.applyMatrix4(a),e.ray.intersectsBox(r)){var n=this.target;t.push({distance:e.ray.origin.distanceTo(n.position),object:n,point:n.position})}}}]),a}(m["F"]),T=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"type","VisMeshHelper"),E(Object(c["a"])(r),"cachaGeometryUUid");var n=1;return r.target=e,r.geometry=new m["r"](e.geometry,n),r.cachaGeometryUUid=e.geometry.uuid,r.material=L(),r.raycast=function(){},r.matrixAutoUpdate=!1,r.matrix=e.matrix,r.onBeforeRender=function(){var e=r.target;e.geometry.uuid!==r.cachaGeometryUUid&&(r.geometry.dispose(),r.geometry=new m["r"](e.geometry,n),r.cachaGeometryUUid=e.geometry.uuid)},r}return Object(d["a"])(a)}(m["F"]);(function(e){e["ADD"]="add",e["REMOVE"]="remove"})(r||(r={}));var x,D,I,P=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"map"),E(Object(c["a"])(r),"scene"),r.map=new Map,r.scene=e,r}return Object(d["a"])(a,[{key:"getMap",value:function(){return this.map}},{key:"add",value:function(e){if(!a.filterHelperMap[e.type])if(a.typeHelperMap[e.type]){var t=new a.typeHelperMap[e.type](e);this.map.set(e,t),this.scene._add(t),this.dispatchEvent({type:r.ADD,helper:t,object:e})}else console.warn("Scene helper compiler can not support this type object: '".concat(e.type,"'"))}},{key:"remove",value:function(e){if(!a.filterHelperMap[e.type])if(this.map.has(e)){var t=this.map.get(e);this.scene._remove(t),t.geometry.dispose(),t.material&&(t.material instanceof m["M"]?t.material.dispose():t.material.forEach((function(e){e.dispose()}))),this.map.delete(e),this.dispatchEvent({type:r.REMOVE,helper:t,object:e})}else console.warn("Scene helper compiler can not found this object`s helper: ".concat(e))}},{key:"setVisiable",value:function(e){var t=this.scene;e?this.map.forEach((function(e,a){t._add(e)})):this.map.forEach((function(e,a){t._remove(e)}))}},{key:"resetHelperColor",value:function(){for(var e=this.map,t=a.helperColorHex,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach((function(a){if(e.has(a)){var r=e.get(a);r.material.color.setHex(t)}}))}},{key:"setHelperHoverColor",value:function(){for(var e=this.map,t=a.hoverColorHex,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach((function(a){if(e.has(a)){var r=e.get(a);r.material.color.setHex(t)}}))}},{key:"setHelperActiveColor",value:function(){for(var e=this.map,t=a.activeColorHex,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];n.forEach((function(a){if(e.has(a)){var r=e.get(a);r.material.color.setHex(t)}}))}}]),a}(m["t"]),N=P;E(N,"helperColorHex",new m["k"](A).getHex()),E(N,"activeColorHex",new m["k"](C).getHex()),E(N,"hoverColorHex",new m["k"](S).getHex()),E(N,"typeHelperMap",{PointLight:k,PerspectiveCamera:R,OrthographicCamera:R,Mesh:T}),E(N,"filterHelperMap",{AmbientLight:!0,Object3D:!0}),function(e){e["DefaultPerspectiveCamera"]="DefaultPerspectiveCamera",e["DefaultOrthograpbicCamera"]="DefaultOrthograpbicCamera"}(x||(x={})),function(e){e["DEFAULT"]="default",e["TOP"]="top",e["BOTTOM"]="bottom",e["LEFT"]="left",e["RIGHT"]="right",e["FRONT"]="front",e["BACK"]="back"}(D||(D={})),function(e){e["GEOMETRY"]="geometry",e["MATERIAL"]="material",e["LIGHT"]="light",e["ENV"]="env"}(I||(I={})),m["lb"].prototype.add=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(!arguments.length)return this;if(arguments.length>1){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}var n=t[0];if(n===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this;if(n&&n.isObject3D){if(null!==n.parent){var i=this.children.indexOf(n);-1!==i&&(n.parent=null,this.children.splice(i,1),n.dispatchEvent({type:"removed"}))}n.parent=this,this.children.push(n),n.dispatchEvent({type:"added"})}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t);return this};var G,H,z,V,F=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r,n,i,l,u,h,d,v,b,g,O,y,j;if(Object(p["a"])(this,a),j=t.call(this),E(Object(c["a"])(j),"cameraSet"),E(Object(c["a"])(j),"lightSet"),E(Object(c["a"])(j),"meshSet"),E(Object(c["a"])(j),"lineSet"),E(Object(c["a"])(j),"pointsSet"),E(Object(c["a"])(j),"spriteSet"),E(Object(c["a"])(j),"helperCompiler"),E(Object(c["a"])(j),"resetHoverObjectSet"),E(Object(c["a"])(j),"resetActiveObjectSet"),E(Object(c["a"])(j),"displayMode"),E(Object(c["a"])(j),"meshOverrideMaterial"),E(Object(c["a"])(j),"lineOverrideMaterial"),E(Object(c["a"])(j),"pointsOverrideMaterial"),E(Object(c["a"])(j),"spriteOverrideMaterial"),E(Object(c["a"])(j),"materialCacheMap"),E(Object(c["a"])(j),"defaultAmbientLight"),E(Object(c["a"])(j),"defaultDirectionalLight"),E(Object(c["a"])(j),"backgroundCache"),E(Object(c["a"])(j),"environmentCache"),E(Object(c["a"])(j),"defaultPerspectiveCamera"),E(Object(c["a"])(j),"defaultOrthograpbicCamera"),E(Object(c["a"])(j),"axesHelper"),E(Object(c["a"])(j),"gridHelper"),E(Object(c["a"])(j),"showAxesHelper"),E(Object(c["a"])(j),"showGridHelper"),E(Object(c["a"])(j),"getDefaultPerspectiveCamera"),E(Object(c["a"])(j),"getDefaultOrthographicCamera"),E(Object(c["a"])(j),"setAxesHelper"),E(Object(c["a"])(j),"setGridHelper"),E(Object(c["a"])(j),"switchDisplayMode"),E(Object(c["a"])(j),"setDisplayMode"),j.cameraSet=new Set,j.lightSet=new Set,j.meshSet=new Set,j.lineSet=new Set,j.pointsSet=new Set,j.spriteSet=new Set,j.helperCompiler=new N(Object(c["a"])(j)),j.resetHoverObjectSet=new Set,j.resetActiveObjectSet=new Set,e.hasDefaultPerspectiveCamera&&(e.defaultPerspectiveCameraSetting?j.defaultPerspectiveCamera=new m["bb"](e.defaultPerspectiveCameraSetting.fov,e.defaultPerspectiveCameraSetting.aspect,e.defaultPerspectiveCameraSetting.near,e.defaultPerspectiveCameraSetting.far):j.defaultPerspectiveCamera=new m["bb"](45,window.innerWidth/window.innerHeight,1,1e3),j.defaultPerspectiveCamera.position.set(50,50,50),j.defaultPerspectiveCamera.lookAt(0,0,0),j.defaultPerspectiveCamera.name="默认透视相机",j.cameraSet.add(j.defaultPerspectiveCamera),j.getDefaultPerspectiveCamera=function(){return this.defaultPerspectiveCamera}),e.hasDefaultOrthographicCamera){if(e.defaultOrthographicCameraSetting){var M=e.defaultOrthographicCameraSetting;j.defaultOrthograpbicCamera=new m["Y"](M.left,M.right,M.top,M.bottom,M.near,M.far)}else{var w=window.innerWidth/2,C=window.innerHeight/2;j.defaultOrthograpbicCamera=new m["Y"](-w/8,w/8,C/8,-C/8,1,1e3)}j.defaultOrthograpbicCamera.name="默认正交相机",j.cameraSet.add(j.defaultOrthograpbicCamera),j.getDefaultOrthographicCamera=function(){return this.defaultOrthograpbicCamera},j.addEventListener("".concat(D.TOP,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(0,60,0)})),j.addEventListener("".concat(D.BOTTOM,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(0,-60,0)})),j.addEventListener("".concat(D.RIGHT,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(60,0,0)})),j.addEventListener("".concat(D.LEFT,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(-60,0,0)})),j.addEventListener("".concat(D.FRONT,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(0,0,60)})),j.addEventListener("".concat(D.BACK,"ViewPoint"),(function(e){j.defaultOrthograpbicCamera.position.set(0,0,-60)}))}if(e.hasAxesHelper&&(j.axesHelper=new m["b"](500),j.axesHelper.matrixAutoUpdate=!1,j.axesHelper.raycast=function(){},Object(o["a"])((r=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",r).call(r,j.axesHelper),j.setAxesHelper=function(e){var t=this.axesHelper;if(e.size){var a=t.geometry.getAttribute("position");a.setX(e.size,1),a.setY(e.size,3),a.setZ(e.size,5),a.needsUpdate=!0}void 0!==Object(f["a"])(e.visiable)&&(t.visible=e.visiable)},j.showAxesHelper=function(e){e?Object(o["a"])((n=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",n).call(n,j.axesHelper):Object(o["a"])((i=Object(c["a"])(j),Object(s["a"])(a.prototype)),"remove",i).call(i,j.axesHelper)}),e.hasGridHelper){var S=new m["z"](500,50,"rgb(130, 130, 130)","rgb(70, 70, 70)");if(S.raycast=function(){},S.material instanceof m["M"]){var A=S.material;A.transparent=!0,A.opacity=.5,A.needsUpdate=!0}S.matrixAutoUpdate=!1,S.raycast=function(){},j.gridHelper=S,Object(o["a"])((l=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",l).call(l,S),j.addEventListener("".concat(D.DEFAULT,"ViewPoint"),(function(e){S.rotation.set(0,0,0),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.TOP,"ViewPoint"),(function(e){S.rotation.set(0,0,0),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.BOTTOM,"ViewPoint"),(function(e){S.rotation.set(0,0,0),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.RIGHT,"ViewPoint"),(function(e){S.rotation.set(0,0,Math.PI/2),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.LEFT,"ViewPoint"),(function(e){S.rotation.set(0,0,Math.PI/2),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.FRONT,"ViewPoint"),(function(e){S.rotation.set(Math.PI/2,0,0),S.updateMatrix(),S.updateMatrixWorld()})),j.addEventListener("".concat(D.BACK,"ViewPoint"),(function(e){S.rotation.set(Math.PI/2,0,0),S.updateMatrix(),S.updateMatrixWorld()})),j.showGridHelper=function(e){e?Object(o["a"])((u=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",u).call(u,j.gridHelper):Object(o["a"])((h=Object(c["a"])(j),Object(s["a"])(a.prototype)),"remove",h).call(h,j.gridHelper)}}if(e.hasDisplayMode){var L="rgb(250, 250, 250)";j.meshOverrideMaterial=new m["Q"]({color:L}),j.lineOverrideMaterial=new m["E"]({color:L}),j.pointsOverrideMaterial=new m["gb"]({color:L,size:5,sizeAttenuation:!1}),j.spriteOverrideMaterial=new m["tb"]({color:L}),j.materialCacheMap=new WeakMap,j.defaultAmbientLight=new m["a"]("rgb(255, 255, 255)",.5),j.defaultAmbientLight.matrixAutoUpdate=!1,j.defaultDirectionalLight=new m["o"]("rgb(255, 255, 255)",.3),j.defaultDirectionalLight.castShadow=!1,j.defaultDirectionalLight.position.set(-100,100,100),j.defaultDirectionalLight.updateMatrix(),j.defaultDirectionalLight.updateMatrixWorld(),j.defaultDirectionalLight.matrixAutoUpdate=!1,j.switchDisplayMode=function(e){var t=function(){var e=j.materialCacheMap,t=j.meshOverrideMaterial;j.meshSet.forEach((function(a){e.set(a,a.material),a.material=t}));var a=j.lineOverrideMaterial;j.lineSet.forEach((function(t){e.set(t,t.material),t.material=a}));var r=j.pointsOverrideMaterial;j.pointsSet.forEach((function(t){e.set(t,t.material),t.material=r}));var n=j.spriteOverrideMaterial;j.spriteSet.forEach((function(t){e.set(t,t.material),t.material=n}))},r=function(){var e=j.materialCacheMap;j.meshSet.forEach((function(t){e.get(t)&&(t.material=e.get(t),e.delete(t))})),j.lineSet.forEach((function(t){e.get(t)&&(t.material=e.get(t),e.delete(t))})),j.pointsSet.forEach((function(t){e.get(t)&&(t.material=e.get(t),e.delete(t))})),j.spriteSet.forEach((function(t){e.get(t)&&(t.material=e.get(t),e.delete(t))}))},n=function(){j.lightSet.forEach((function(e){Object(o["a"])((d=Object(c["a"])(j),Object(s["a"])(a.prototype)),"remove",d).call(d,e)})),Object(o["a"])((v=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",v).call(v,j.defaultAmbientLight),Object(o["a"])((b=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",b).call(b,j.defaultDirectionalLight)},i=function(){j.lightSet.forEach((function(e){Object(o["a"])((g=Object(c["a"])(j),Object(s["a"])(a.prototype)),"add",g).call(g,e)})),Object(o["a"])((O=Object(c["a"])(j),Object(s["a"])(a.prototype)),"remove",O).call(O,j.defaultAmbientLight),Object(o["a"])((y=Object(c["a"])(j),Object(s["a"])(a.prototype)),"remove",y).call(y,j.defaultDirectionalLight)},l=function(){j.background instanceof m["wb"]&&(j.backgroundCache=j.background,j.background=null),j.environment instanceof m["wb"]&&(j.environmentCache=j.environment,j.environment=null)},u=function(){j.backgroundCache&&(j.background=j.backgroundCache,j.backgroundCache=void 0),j.environmentCache&&(j.environment=j.environmentCache,j.environmentCache=void 0)};e===I.GEOMETRY?(t(),l(),n()):e===I.MATERIAL?(r(),l(),n()):e===I.LIGHT?(r(),l(),i()):e===I.ENV?(r(),u(),i()):console.warn("VisScene can not set this mode: ".concat(e))},j.setDisplayMode=function(e){j.displayMode=e,j.switchDisplayMode(e)},void 0!==e.displayMode?(j.setDisplayMode(e.displayMode),j.switchDisplayMode(j.displayMode)):(j.setDisplayMode(I.ENV),j.switchDisplayMode(j.displayMode))}return j}return Object(d["a"])(a,[{key:"getHelperCompiler",value:function(){return this.helperCompiler}},{key:"setObjectHelperVisiable",value:function(e){this.helperCompiler.setVisiable(e)}},{key:"setObjectHelperHover",value:function(){for(var e,t,a=this.resetHoverObjectSet,r=this.resetActiveObjectSet,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.forEach((function(e,t,n){a.delete(e),r.has(e)&&n.splice(t,1)})),r.forEach((function(e){a.delete(e)})),(e=this.helperCompiler).resetHelperColor.apply(e,Object(h["a"])(a)),a.clear(),(t=this.helperCompiler).setHelperHoverColor.apply(t,i),i.forEach((function(e){a.add(e)})),this}},{key:"setObjectHelperActive",value:function(){for(var e,t,a=this.resetActiveObjectSet,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.forEach((function(e){a.delete(e)})),(e=this.helperCompiler).resetHelperColor.apply(e,Object(h["a"])(a)),a.clear(),(t=this.helperCompiler).setHelperActiveColor.apply(t,n),n.forEach((function(e){a.add(e)})),this}},{key:"showObjectHelper",value:function(e){return this.helperCompiler.setVisiable(e),this}},{key:"setViewPoint",value:function(e){this.dispatchEvent({type:"".concat(e,"ViewPoint")})}},{key:"add",value:function(){for(var e,t=this,r=0,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return i.forEach((function(e){e instanceof m["O"]?(t.meshSet.add(e),r+=1):e instanceof m["D"]?(t.lineSet.add(e),r+=1):e instanceof m["C"]?(t.lightSet.add(e),r+=1):e instanceof m["fb"]?(t.pointsSet.add(e),r+=1):e instanceof m["sb"]?(t.spriteSet.add(e),r+=1):e instanceof m["f"]&&(t.cameraSet.add(e),r+=1),t.helperCompiler.add(e)})),void 0!==this.displayMode&&r>0&&this.switchDisplayMode(this.displayMode),(e=Object(o["a"])(Object(s["a"])(a.prototype),"add",this)).call.apply(e,[this].concat(i))}},{key:"remove",value:function(){for(var e,t=this,r=this.materialCacheMap,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return i.forEach((function(e){r&&r.has(e)&&r.delete(e),e instanceof m["O"]?t.meshSet.delete(e):e instanceof m["D"]?t.lineSet.delete(e):e instanceof m["C"]?t.lightSet.delete(e):e instanceof m["fb"]?t.pointsSet.delete(e):e instanceof m["sb"]?t.spriteSet.delete(e):e instanceof m["f"]&&t.cameraSet.delete(e),t.helperCompiler.remove(e)})),(e=Object(o["a"])(Object(s["a"])(a.prototype),"remove",this)).call.apply(e,[this].concat(i))}},{key:"_add",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=Object(o["a"])(Object(s["a"])(a.prototype),"add",this)).call.apply(e,[this].concat(r))}},{key:"_remove",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=Object(o["a"])(Object(s["a"])(a.prototype),"remove",this)).call.apply(e,[this].concat(r))}},{key:"updateMaterial",value:function(e){var t;return void 0!==this.displayMode&&"geometry"===this.displayMode&&(null==(t=this.materialCacheMap)||t.set(e,e.material),this.switchDisplayMode&&this.switchDisplayMode(this.displayMode)),this}}]),a}(m["lb"]),U=function(e){var t=this;if(this.scene instanceof F)return console.warn("this has installed modeling scene plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;var a=new F(e);if(this.scene=a,this.render=function(){return t.webGLRenderer.render(a,t.currentCamera),t},e.hasDefaultPerspectiveCamera){var r=a.getDefaultPerspectiveCamera();this.currentCamera=r,a.addEventListener("".concat(D.DEFAULT,"ViewPoint"),(function(e){t.setCamera(r)}))}if(e.hasDefaultOrthographicCamera){var n=a.getDefaultOrthographicCamera();a.addEventListener("".concat(D.TOP,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)})),a.addEventListener("".concat(D.BOTTOM,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)})),a.addEventListener("".concat(D.RIGHT,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)})),a.addEventListener("".concat(D.LEFT,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)})),a.addEventListener("".concat(D.FRONT,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)})),a.addEventListener("".concat(D.BACK,"ViewPoint"),(function(e){t.orbitControls&&t.orbitControls.target.set(0,0,0),t.setCamera(n)}))}return!0},B=function(e){var t=this;if(this.scene)return console.warn("this has installed scene plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;this.scene=new m["lb"],this.render=function(){return t.webGLRenderer.render(t.scene,t.currentCamera),t};var a=new m["bb"];return a.position.set(50,50,50),a.lookAt(0,0,0),this.currentCamera=a,!0};(function(e){e["RENDER"]="render",e["PLAY"]="play",e["STOP"]="stop"})(G||(G={})),function(e){e["HOVERCHANGE"]="hover-change",e["ACTIVECHANGE"]="active-change"}(H||(H={})),function(e){e["POINTERDOWN"]="pointerdown",e["POINTERMOVE"]="pointermove",e["POINTERUP"]="pointerup"}(z||(z={})),function(e){e["SETMATERIAL"]="setMaterial"}(V||(V={}));var W,_=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.apply(this,arguments),E(Object(c["a"])(e),"clock",new m["j"]),E(Object(c["a"])(e),"animationFrame",-1),E(Object(c["a"])(e),"render",(function(){var t=e.clock,a=t.getDelta(),r=t.getElapsedTime();e.dispatchEvent({type:G.RENDER,delta:a,total:r})})),E(Object(c["a"])(e),"play",(function(){e.dispatchEvent({type:G.PLAY});var t=function t(){e.render(),e.animationFrame=requestAnimationFrame(t)};t()})),E(Object(c["a"])(e),"stop",(function(){cancelAnimationFrame(e.animationFrame),e.animationFrame=-1,e.dispatchEvent({type:G.STOP})})),E(Object(c["a"])(e),"checkHasRendering",(function(){return-1!==e.animationFrame})),E(Object(c["a"])(e),"hasVaildRender",(function(){return e.useful()})),e}return Object(d["a"])(a)}(w),Y=function(){return this.renderManager?(console.warn("this has installed render manager plugin."),!1):(this.renderManager=new _,this.render&&this.renderManager.addEventListener("render",this.render),this.render=function(){return this.renderManager.render(),this},this.play=function(){return this.renderManager.play(),this},this.stop=function(){return this.renderManager.stop(),this},!0)},J=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e,r){var n;return Object(p["a"])(this,a),n=t.call(this,e,r),n.mouseButtons={LEFT:null,MIDDLE:m["L"].DOLLY,RIGHT:m["L"].ROTATE},n}return Object(d["a"])(a,[{key:"setCamera",value:function(e){return this.object=e,this.update(),this}}]),a}(v["a"]),X=function(e){var t=this;if(this.orbitControls)return console.warn("this has installed orbitControls plugin."),!1;if(!this.webGLRenderer)return console.warn("this must install renderer before install orbitControls plugin."),!1;if(!this.renderManager)return console.warn("this must install renderManager before install orbitControls plugin."),!1;if(this.orbitControls=new J(this.currentCamera,this.dom),this.addEventListener("setCamera",(function(e){t.orbitControls.setCamera(e.camera)})),this.renderManager.addEventListener("render",(function(){t.orbitControls.update()})),this.scene instanceof F){var a=this.scene;a.addEventListener("".concat(D.DEFAULT,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!0})),a.addEventListener("".concat(D.TOP,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1})),a.addEventListener("".concat(D.BOTTOM,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1})),a.addEventListener("".concat(D.RIGHT,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1})),a.addEventListener("".concat(D.LEFT,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1})),a.addEventListener("".concat(D.FRONT,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1})),a.addEventListener("".concat(D.BACK,"ViewPoint"),(function(e){t.orbitControls.enableRotate=!1}))}return!0},K=Object(d["a"])((function e(t){Object(p["a"])(this,e),E(this,"REVISION"),E(this,"dom"),E(this,"addPanel"),E(this,"showPanel"),E(this,"begin"),E(this,"end"),E(this,"update"),E(this,"domElement"),E(this,"setMode");var a=Object(b["a"])();this.REVISION=a.REVISION,this.dom=a.dom,this.domElement=a.domElement,this.begin=a.begin.bind(a),this.end=a.end.bind(a),this.update=a.update.bind(a),this.addPanel=a.addPanel.bind(a),this.showPanel=a.showPanel.bind(a),this.setMode=a.setMode.bind(a);var r=this.domElement;r.style.position="absolute",r.style.top="0",r.style.left="35px",t&&(r.style.top="".concat(t.top,"px"),r.style.left="".concat(t.left,"px"),r.style.right="".concat(t.right,"px"),r.style.bottom="".concat(t.bottom,"px"))})),Z=function(e){var t=this;if(this.stats)return console.warn("this has installed stats plugin."),!1;if(!this.renderManager)return console.warn("this must install renderManager before install stats plugin."),!1;var a=new K(e);return this.stats=a,this.setStats=function(e){if(e)this.dom.appendChild(this.stats.domElement);else try{this.dom.removeChild(this.stats.domElement)}catch(t){}return this},this.renderManager.addEventListener("render",(function(){t.stats.update()})),!0},q=function(e){var t,a,r=this;if(this.effectComposer)return console.warn("this has installed effect composer plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;if(null==e?void 0:e.WebGLMultisampleRenderTarget){var n=this.webGLRenderer,i=n.getPixelRatio(),o=n.getDrawingBufferSize(new m["Bb"]);t=new g["a"](n,new m["Db"](o.width*i,o.height*i,{format:m["ib"]}))}else t=new g["a"](this.webGLRenderer);return this.effectComposer=t,this.scene?(a=new O["a"](this.scene,this.currentCamera),t.addPass(a),this.addEventListener("setCamera",(function(e){a.camera=e.camera})),this.addEventListener("setSize",(function(e){t.setSize(e.width,e.height)})),this.renderManager&&this.renderManager.removeEventListener("render",this.render),this.render=function(){return r.effectComposer.render(),r},this.renderManager&&this.renderManager.addEventListener("render",(function(e){r.effectComposer.render(e.delta)})),!0):(console.error("composer con not found support scene plugin."),!1)},Q=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"dom"),E(Object(c["a"])(r),"mouse"),E(Object(c["a"])(r),"canMouseMove"),E(Object(c["a"])(r),"mouseEventTimer"),E(Object(c["a"])(r),"throttleTime");var n=e.dom;return r.dom=n,r.mouse=new m["Bb"],r.canMouseMove=!0,r.mouseEventTimer=null,r.throttleTime=e.throttleTime||1e3/60,n.addEventListener("pointerdown",(function(e){r.pointerDown(e)})),n.addEventListener("pointermove",(function(e){r.canMouseMove&&(r.canMouseMove=!1,r.mouseEventTimer=setTimeout((function(){var t=r.mouse,a=r.dom;t.x=e.offsetX/a.offsetWidth*2-1,t.y=-e.offsetY/a.offsetHeight*2+1,r.canMouseMove=!0,r.pointerMove(e)}),r.throttleTime))})),n.addEventListener("pointerup",(function(e){r.pointerUp(e)})),r}return Object(d["a"])(a,[{key:"getMousePoint",value:function(){return this.mouse}},{key:"pointerDown",value:function(e){var t={mouse:this.mouse};for(var a in e)t[a]=e[a];this.dispatchEvent(t)}},{key:"pointerMove",value:function(e){var t={mouse:this.mouse};for(var a in e)t[a]=e[a];this.dispatchEvent(t)}},{key:"pointerUp",value:function(e){var t={mouse:this.mouse};for(var a in e)t[a]=e[a];this.dispatchEvent(t)}}]),a}(w),$=function(e){if(this.pointerManager)return console.warn("this has installed pointerManager plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;var t=new Q(Object.assign(e||{},{dom:this.dom}));return this.pointerManager=t,!0},ee=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"raycaster"),E(Object(c["a"])(r),"scene"),E(Object(c["a"])(r),"camera"),E(Object(c["a"])(r),"recursive",!1),E(Object(c["a"])(r),"penetrate",!1),r.raycaster=new m["jb"],r.camera=e.camera,r.scene=e.scene,e.recursive&&(r.recursive=e.recursive),e.penetrate&&(r.penetrate=e.penetrate),r}return Object(d["a"])(a,[{key:"setCamera",value:function(e){return this.camera=e,this}},{key:"intersectObject",value:function(e){return this.raycaster.setFromCamera(e,this.camera),this.raycaster.intersectObjects(this.scene.children,this.recursive)}},{key:"use",value:function(e){var t=this,a=function(e,t){return Object.assign({},e,t)};e.addEventListener("pointerdown",(function(e){var r=t.intersectObject(e.mouse);if(t.dispatchEvent(a(e,{type:"pointerdown",intersections:r})),t.dispatchEvent(a(e,{type:"mousedown",intersections:r})),r.length)if(t.penetrate){var n,o=Object(i["a"])(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.object.dispatchEvent(a(e,{type:"pointerdown",intersection:s})),s.object.dispatchEvent(a(e,{type:"mousedown",intersection:s}))}}catch(l){o.e(l)}finally{o.f()}}else{var c=r[0];c.object.dispatchEvent(a(e,{type:"pointerdown",intersection:c})),c.object.dispatchEvent(a(e,{type:"mousedown",intersection:c}))}}));var r=new Map;return e.addEventListener("pointermove",(function(e){var n=t.intersectObject(e.mouse);if(t.dispatchEvent(a(e,{type:"pointermove",intersections:n})),t.dispatchEvent(a(e,{type:"mousemove",intersections:n})),n.length){if(t.penetrate){var o,s=Object(i["a"])(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;r.has(c.object)?(c.object.dispatchEvent(a(e,{type:"pointermove",intersection:c})),c.object.dispatchEvent(a(e,{type:"mousemove",intersection:c}))):(c.object.dispatchEvent(a(e,{type:"pointerenter",intersection:c})),c.object.dispatchEvent(a(e,{type:"mouseenter",intersection:c})))}}catch(d){s.e(d)}finally{s.f()}}else{var l=n[0];r.has(l.object)?(l.object.dispatchEvent(a(e,{type:"pointermove",intersection:l})),l.object.dispatchEvent(a(e,{type:"mousemove",intersection:l}))):(l.object.dispatchEvent(a(e,{type:"pointerenter",intersection:l})),l.object.dispatchEvent(a(e,{type:"mouseenter",intersection:l})))}var u,h=Object(i["a"])(n);try{for(h.s();!(u=h.n()).done;){var p=u.value;r.set(p.object,p)}}catch(d){h.e(d)}finally{h.f()}}else r.forEach((function(t){t.object.dispatchEvent(a(e,{type:"pointerleave",intersection:t})),t.object.dispatchEvent(a(e,{type:"mouseleave",intersection:t}))})),r.clear()})),e.addEventListener("pointerup",(function(e){var r=t.intersectObject(e.mouse);if(t.dispatchEvent(a(e,{type:"pointerup",intersections:r})),t.dispatchEvent(a(e,{type:"mouseup",intersections:r})),t.dispatchEvent(a(e,{type:"click",intersections:r})),r.length)if(t.penetrate){var n,o=Object(i["a"])(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.object.dispatchEvent(a(e,{type:"pointerup",intersection:s})),s.object.dispatchEvent(a(e,{type:"mouseup",intersection:s})),s.object.dispatchEvent(a(e,{type:"click",intersection:s}))}}catch(l){o.e(l)}finally{o.f()}}else{var c=r[0];c.object.dispatchEvent(a(e,{type:"pointerup",intersection:c})),c.object.dispatchEvent(a(e,{type:"mouseup",intersection:c})),c.object.dispatchEvent(a(e,{type:"click",intersection:c}))}})),this}}]),a}(w),te=function(e){var t=this;if(this.eventManager)return console.warn("engine has installed eventManager plugin."),!1;if(!this.webGLRenderer)return console.error("must install some renderer before this plugin."),!1;if(!this.pointerManager)return console.error("must install pointerManager before this plugin."),!1;var a=new ee(Object.assign({scene:this.scene,camera:this.currentCamera},e));return a.use(this.pointerManager),this.eventManager=a,this.addEventListener("setCamera",(function(e){t.eventManager.setCamera(e.camera)})),this.scene instanceof F&&(this.eventManager.addEventListener("pointermove",(function(e){var a;(a=t.scene).setObjectHelperHover.apply(a,Object(h["a"])(e.intersections.map((function(e){return e.object}))))})),this.eventManager.addEventListener("click",(function(e){var a;t.transing?t.transing=!1:0===e.button&&(a=t.scene).setObjectHelperActive.apply(a,Object(h["a"])(e.intersections.map((function(e){return e.object}))))}))),!0};(function(e){e["OBJECTCHANGE"]="objectChange",e["OBJECTCHANGED"]="objectChanged"})(W||(W={}));var ae=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e,r){var n;Object(p["a"])(this,a),n=t.call(this,e,r),E(Object(c["a"])(n),"target"),E(Object(c["a"])(n),"transObjectSet"),n.domElement.removeEventListener("pointerdown",n._onPointerDown),n._onPointerDown=function(e){var t;n.enabled&&(null==(t=n.object)?void 0:t.parent)&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",n._onPointerMove),n.pointerHover(n._getPointer(e)),n.pointerDown(n._getPointer(e)))},n.domElement.addEventListener("pointerdown",n._onPointerDown),n.target=new m["V"],n.transObjectSet=new Set;var i="",o=n.target,s=n.transObjectSet,l={x:0,y:0,z:0},u=new WeakMap;return n.addEventListener("mouseDown",(function(e){i=e.target.mode,"translate"===i&&(i="position"),"rotate"===i&&(i="rotation"),l.x=o[i].x,l.y=o[i].y,l.z=o[i].z,s.forEach((function(e){u.set(e,e.matrixAutoUpdate),e.matrixAutoUpdate=!1}))})),n.addEventListener("objectChange",(function(e){var t=o[i].x-l.x,a=o[i].y-l.y,r=o[i].z-l.z;l.x=o[i].x,l.y=o[i].y,l.z=o[i].z,s.forEach((function(e){e[i].x+=t,e[i].y+=a,e[i].z+=r,e.updateMatrix(),e.updateMatrixWorld()})),n.dispatchEvent({type:W.OBJECTCHANGED,transObjectSet:s,mode:i,target:o})})),n.addEventListener("mouseUp",(function(e){s.forEach((function(e){e.matrixAutoUpdate=u.get(e),u.delete(e)}))})),n}return Object(d["a"])(a,[{key:"getTarget",value:function(){return this.target}},{key:"getTransObjectSet",value:function(){return this.transObjectSet}},{key:"setCamera",value:function(e){return this.camera=e,this}},{key:"setAttach",value:function(){var e=this;this.transObjectSet.clear();for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];if(!a.length||!a[0])return this.detach(),this;this.attach(this.target);var n=this.target;if(1===a.length){var i=a[0];return n.scale.copy(i.scale),n.rotation.copy(i.rotation),n.position.copy(i.position),n.updateMatrix(),n.updateMatrixWorld(),this.transObjectSet.add(i),this}var o=[],s=[],c=[];return a.forEach((function(e){o.push(e.position.x),s.push(e.position.y),c.push(e.position.z)})),n.rotation.set(0,0,0),n.scale.set(0,0,0),n.position.x=(Math.max.apply(Math,o)-Math.min.apply(Math,o))/2+Math.min.apply(Math,o),n.position.y=(Math.max.apply(Math,s)-Math.min.apply(Math,s))/2+Math.min.apply(Math,s),n.position.z=(Math.max.apply(Math,c)-Math.min.apply(Math,c))/2+Math.min.apply(Math,c),n.updateMatrix(),n.updateMatrixWorld(),a.forEach((function(t){e.transObjectSet.add(t)})),this}}]),a}(y["a"]),re=function(e){var t=this;if(this.transformControls)return console.warn("this has installed transformControls plugin."),!1;if(!this.webGLRenderer)return console.warn("this must install renderer before install transformControls plugin."),!1;if(!this.pointerManager)return console.warn("this must install pointerManager before install transformControls plugin."),!1;if(!this.eventManager)return console.warn("this must install eventManager before install transformControls plugin."),!1;var a=new ae(this.currentCamera,this.dom);return this.transformControls=a,this.transing=!1,a.addEventListener("mouseDown",(function(){t.transing=!0})),this.scene instanceof m["lb"]?(this.scene.add(this.transformControls),this.scene.add(this.transformControls.target)):this.scene instanceof F&&(this.scene._add(this.transformControls),this.scene._add(this.transformControls.target)),this.setTransformControls=function(e){return this.transformControls.visible=e,this},this.addEventListener("setCamera",(function(e){a.setCamera(e.camera)})),this.eventManager.addEventListener("pointerup",(function(e){if(!t.transing&&0===e.button){var r=e.intersections.map((function(e){return e.object}));a.setAttach(r[0])}})),!0},ne=function(e){var t=this;return this.webGLRenderer?(console.warn("this has installed webglRenderer plugin."),!1):(this.webGLRenderer=new m["Fb"](e),this.dom=this.webGLRenderer.domElement,this.setSize=function(e,t){var a,r;return e&&e<=0||t&&t<=0?(console.warn("you must be input width and height bigger then zero, width: ".concat(e,", height: ").concat(t)),this):(!e&&(e=null==(a=this.dom)?void 0:a.offsetWidth),!t&&(t=null==(r=this.dom)?void 0:r.offsetHeight),this.dispatchEvent({type:"setSize",width:e,height:t}),this)},this.setCamera=function(e){return this.currentCamera=e,this.dispatchEvent({type:"setCamera",camera:e}),this},this.setDom=function(e){return this.dom=e,e.appendChild(this.webGLRenderer.domElement),this},this.addEventListener("setSize",(function(e){var a=e.width,r=e.height;t.webGLRenderer.setSize(a,r,!0);var n=t.currentCamera;n&&(n instanceof m["bb"]?(n.aspect=e.width/e.height,n.updateProjectionMatrix()):n instanceof m["Y"]&&(n.left=-a/16,n.right=a/16,n.top=r/16,n.bottom=-r/16,n.updateProjectionMatrix()))})),this.addEventListener("dispose",(function(){t.webGLRenderer.dispose()})),!0)},ie=/^[og]\s*(.+)?/,oe=/^mtllib /,se=/^usemtl /,ce=/^usemap /,le=new m["Cb"],ue=new m["Cb"],he=new m["Cb"],pe=new m["Cb"],de=new m["Cb"];function fe(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var a=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);var r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==a?a.smooth:this.smooth,groupStart:void 0!==a?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"===typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},a&&a.name&&"function"===typeof a.clone){var r=a.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var a=parseInt(e,10);return 3*(a>=0?a-1:a+t/3)},parseNormalIndex:function(e,t){var a=parseInt(e,10);return 3*(a>=0?a-1:a+t/3)},parseUVIndex:function(e,t){var a=parseInt(e,10);return 2*(a>=0?a-1:a+t/2)},addVertex:function(e,t,a){var r=this.vertices,n=this.object.geometry.vertices;n.push(r[e+0],r[e+1],r[e+2]),n.push(r[t+0],r[t+1],r[t+2]),n.push(r[a+0],r[a+1],r[a+2])},addVertexPoint:function(e){var t=this.vertices,a=this.object.geometry.vertices;a.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices,a=this.object.geometry.vertices;a.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,a){var r=this.normals,n=this.object.geometry.normals;n.push(r[e+0],r[e+1],r[e+2]),n.push(r[t+0],r[t+1],r[t+2]),n.push(r[a+0],r[a+1],r[a+2])},addFaceNormal:function(e,t,a){var r=this.vertices,n=this.object.geometry.normals;le.fromArray(r,e),ue.fromArray(r,t),he.fromArray(r,a),de.subVectors(he,ue),pe.subVectors(le,ue),de.cross(pe),de.normalize(),n.push(de.x,de.y,de.z),n.push(de.x,de.y,de.z),n.push(de.x,de.y,de.z)},addColor:function(e,t,a){var r=this.colors,n=this.object.geometry.colors;void 0!==r[e]&&n.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&n.push(r[t+0],r[t+1],r[t+2]),void 0!==r[a]&&n.push(r[a+0],r[a+1],r[a+2])},addUV:function(e,t,a){var r=this.uvs,n=this.object.geometry.uvs;n.push(r[e+0],r[e+1]),n.push(r[t+0],r[t+1]),n.push(r[a+0],r[a+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs,a=this.object.geometry.uvs;a.push(t[e+0],t[e+1])},addFace:function(e,t,a,r,n,i,o,s,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),h=this.parseVertexIndex(t,l),p=this.parseVertexIndex(a,l);if(this.addVertex(u,h,p),this.addColor(u,h,p),void 0!==o&&""!==o){var d=this.normals.length;u=this.parseNormalIndex(o,d),h=this.parseNormalIndex(s,d),p=this.parseNormalIndex(c,d),this.addNormal(u,h,p)}else this.addFaceNormal(u,h,p);if(void 0!==r&&""!==r){var f=this.uvs.length;u=this.parseUVIndex(r,f),h=this.parseUVIndex(n,f),p=this.parseUVIndex(i,f),this.addUV(u,h,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,a=0,r=e.length;a<r;a++){var n=this.parseVertexIndex(e[a],t);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var a=this.vertices.length,r=this.uvs.length,n=0,i=e.length;n<i;n++)this.addVertexLine(this.parseVertexIndex(e[n],a));for(var o=0,s=t.length;o<s;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return e.startObject("",!1),e}var me,ve=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),r.materials=null,r}return Object(d["a"])(a,[{key:"load",value:function(e,t,a,r){var n=this,i=new m["u"](this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(a){try{t(n.parse(a))}catch(i){r?r(i):console.error(i),n.manager.itemError(e)}}),a,r)}},{key:"setMaterials",value:function(e){return this.materials=e,this}},{key:"parse",value:function(e){var t=new fe;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));for(var a=e.split("\n"),r="",n="",i=0,o=[],s="function"===typeof"".trimLeft,c=0,l=a.length;c<l;c++)if(r=a[c],r=s?r.trimLeft():r.trim(),i=r.length,0!==i&&(n=r.charAt(0),"#"!==n))if("v"===n){var u=r.split(/\s+/);switch(u[0]){case"v":t.vertices.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),u.length>=7?t.colors.push(parseFloat(u[4]),parseFloat(u[5]),parseFloat(u[6])):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));break;case"vt":t.uvs.push(parseFloat(u[1]),parseFloat(u[2]));break}}else if("f"===n){for(var h=r.substr(1).trim(),p=h.split(/\s+/),d=[],f=0,v=p.length;f<v;f++){var b=p[f];if(b.length>0){var g=b.split("/");d.push(g)}}for(var O=d[0],y=1,j=d.length-1;y<j;y++){var M=d[y],E=d[y+1];t.addFace(O[0],M[0],E[0],O[1],M[1],E[1],O[2],M[2],E[2])}}else if("l"===n){var w=r.substring(1).trim().split(" "),C=[],S=[];if(-1===r.indexOf("/"))C=w;else for(var A=0,L=w.length;A<L;A++){var k=w[A].split("/");""!==k[0]&&C.push(k[0]),""!==k[1]&&S.push(k[1])}t.addLineGeometry(C,S)}else if("p"===n){var R=r.substr(1).trim(),T=R.split(" ");t.addPointGeometry(T)}else if(null!==(o=ie.exec(r))){var x=(" "+o[0].substr(1).trim()).substr(1);t.startObject(x)}else if(se.test(r))t.object.startMaterial(r.substring(7).trim(),t.materialLibraries);else if(oe.test(r))t.materialLibraries.push(r.substring(7).trim());else if(ce.test(r))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===n){if(o=r.split(" "),o.length>1){var D=o[1].trim().toLowerCase();t.object.smooth="0"!==D&&"off"!==D}else t.object.smooth=!0;var I=t.object.currentMaterial();I&&(I.smooth=t.object.smooth)}else{if("\0"===r)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+r+'"')}t.finalize();var P=new m["A"];P.materialLibraries=[].concat(t.materialLibraries);var N=!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length);if(!0===N)for(var G=0,H=t.objects.length;G<H;G++){var z=t.objects[G],V=z.geometry,F=z.materials,U="Line"===V.type,B="Points"===V.type,W=!1;if(0!==V.vertices.length){var _=new m["e"];_.setAttribute("position",new m["v"](V.vertices,3)),V.normals.length>0&&_.setAttribute("normal",new m["v"](V.normals,3)),V.colors.length>0&&(W=!0,_.setAttribute("color",new m["v"](V.colors,3))),!0===V.hasUVIndices&&_.setAttribute("uv",new m["v"](V.uvs,2));for(var Y=[],J=0,X=F.length;J<X;J++){var K=F[J],Z=K.name+"_"+K.smooth+"_"+W,q=t.materials[Z];if(null!==this.materials)if(q=this.materials.create(K.name),!U||!q||q instanceof m["E"]){if(B&&q&&!(q instanceof m["gb"])){var Q=new m["gb"]({size:10,sizeAttenuation:!1});m["M"].prototype.copy.call(Q,q),Q.color.copy(q.color),Q.map=q.map,q=Q}}else{var $=new m["E"];m["M"].prototype.copy.call($,q),$.color.copy(q.color),q=$}void 0===q&&(q=U?new m["E"]:B?new m["gb"]({size:1,sizeAttenuation:!1}):new m["R"],q.name=K.name,q.flatShading=!K.smooth,q.vertexColors=W,t.materials[Z]=q),Y.push(q)}var ee=void 0;if(Y.length>1){for(var te=0,ae=F.length;te<ae;te++){var re=F[te];_.addGroup(re.groupStart,re.groupCount,te)}ee=U?new m["F"](_,Y):B?new m["fb"](_,Y):new m["O"](_,Y)}else ee=U?new m["F"](_,Y[0]):B?new m["fb"](_,Y[0]):new m["O"](_,Y[0]);ee.name=z.name,P.add(ee)}}else if(t.vertices.length>0){var ne=new m["gb"]({size:1,sizeAttenuation:!1}),le=new m["e"];le.setAttribute("position",new m["v"](t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(le.setAttribute("color",new m["v"](t.colors,3)),ne.vertexColors=!0);var ue=new m["fb"](le,ne);P.add(ue)}return P}}]),a}(m["J"]),be=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),t.call(this,e)}return Object(d["a"])(a,[{key:"load",value:function(e,t,a,r){var n=this,i=""===this.path?m["K"].extractUrlBase(e):this.path,o=new m["u"](this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(a){try{t(n.parse(a,i))}catch(o){r?r(o):console.error(o),n.manager.itemError(e)}}),a,r)}},{key:"setMaterialOptions",value:function(e){return this.materialOptions=e,this}},{key:"parse",value:function(e,t){for(var a=e.split("\n"),r={},n=/\s+/,i={},o=0;o<a.length;o++){var s=a[o];if(s=s.trim(),0!==s.length&&"#"!==s.charAt(0)){var c=s.indexOf(" "),l=c>=0?s.substring(0,c):s;l=l.toLowerCase();var u=c>=0?s.substring(c+1):"";if(u=u.trim(),"newmtl"===l)r={name:u},i[u]=r;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=u.split(n,3);r[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else r[l]=u}}var p=new ge(this.resourcePath||t,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(i),p}}]),a}(m["J"]),ge=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p["a"])(this,e),this.baseUrl=t,this.options=a,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:m["y"],this.wrap=void 0!==this.options.wrap?this.options.wrap:m["kb"]}return Object(d["a"])(e,[{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setManager",value:function(e){this.manager=e}},{key:"setMaterials",value:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}},{key:"convert",value:function(e){if(!this.options)return e;var t={};for(var a in e){var r=e[a],n={};for(var i in t[a]=n,r){var o=!0,s=r[i],c=i.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(o=!1);break}o&&(n[c]=s)}}return t}},{key:"preload",value:function(){for(var e in this.materialsInfo)this.create(e)}},{key:"getIndex",value:function(e){return this.nameLookup[e]}},{key:"getAsArray",value:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}},{key:"create",value:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}},{key:"createMaterial_",value:function(e){var t=this,a=this.materialsInfo[e],r={name:e,side:this.side};function n(e,t){return"string"!==typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}function i(e,a){if(!r[e]){var i=t.getTextureParams(a,r),o=t.loadTexture(n(t.baseUrl,i.url));o.repeat.copy(i.scale),o.offset.copy(i.offset),o.wrapS=t.wrap,o.wrapT=t.wrap,r[e]=o}}for(var o in a){var s=a[o],c=void 0;if(""!==s)switch(o.toLowerCase()){case"kd":r.color=(new m["k"]).fromArray(s);break;case"ks":r.specular=(new m["k"]).fromArray(s);break;case"ke":r.emissive=(new m["k"]).fromArray(s);break;case"map_kd":i("map",s);break;case"map_ks":i("specularMap",s);break;case"map_ke":i("emissiveMap",s);break;case"norm":i("normalMap",s);break;case"map_bump":case"bump":i("bumpMap",s);break;case"map_d":i("alphaMap",s),r.transparent=!0;break;case"ns":r.shininess=parseFloat(s);break;case"d":c=parseFloat(s),c<1&&(r.opacity=c,r.transparent=!0);break;case"tr":c=parseFloat(s),this.options&&this.options.invertTrProperty&&(c=1-c),c>0&&(r.opacity=1-c,r.transparent=!0);break}}return this.materials[e]=new m["R"](r),this.materials[e]}},{key:"getTextureParams",value:function(e,t){var a,r={scale:new m["Bb"](1,1),offset:new m["Bb"](0,0)},n=e.split(/\s+/);return a=n.indexOf("-bm"),a>=0&&(t.bumpScale=parseFloat(n[a+1]),n.splice(a,2)),a=n.indexOf("-s"),a>=0&&(r.scale.set(parseFloat(n[a+1]),parseFloat(n[a+2])),n.splice(a,4)),a=n.indexOf("-o"),a>=0&&(r.offset.set(parseFloat(n[a+1]),parseFloat(n[a+2])),n.splice(a,4)),r.url=n.join(" ").trim(),r}},{key:"loadTexture",value:function(e,t,a,r,n){var i=void 0!==this.manager?this.manager:m["n"],o=i.getHandler(e);null===o&&(o=new m["xb"](i)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin);var s=o.load(e,a,r,n);return void 0!==t&&(s.mapping=t),s}}]),e}();(function(e){e["LOADING"]="loading",e["DETAILLOADING"]="detailLoading",e["DETAILLOADED"]="detailLoaded",e["LOADED"]="loaded"})(me||(me={}));var Oe,ye,je=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"resourceMap"),E(Object(c["a"])(r),"loaderMap"),E(Object(c["a"])(r),"loadTotal"),E(Object(c["a"])(r),"loadSuccess"),E(Object(c["a"])(r),"loadError"),E(Object(c["a"])(r),"isError"),E(Object(c["a"])(r),"isLoading"),E(Object(c["a"])(r),"isLoaded"),E(Object(c["a"])(r),"loadDetailMap"),r.resourceMap=new Map,r.loadTotal=0,r.loadSuccess=0,r.loadError=0,r.isError=!1,r.isLoading=!1,r.isLoaded=!1,r.loadDetailMap={};var n=new m["B"];return r.loaderMap={jpg:n,png:n,jpeg:n,obj:new ve,mtl:new be},e&&(r.loaderMap=Object.assign(r.loaderMap,e.loaderExtends)),r}return Object(d["a"])(a,[{key:"loaded",value:function(){return this.dispatchEvent({type:me.LOADED,loadTotal:this.loadTotal,loadSuccess:this.loadSuccess,loadError:this.loadError,resourceMap:this.resourceMap}),this}},{key:"checkLoaded",value:function(){return this.loadTotal===this.loadSuccess+this.loadError&&(this.isError=!0,this.isLoaded=!0,this.isLoading=!1,this.loaded()),this}},{key:"load",value:function(e){var t,a=this;if(this.reset(),this.isLoading=!0,e.length<=0)return this.checkLoaded(),console.warn("url list is empty."),this;this.loadTotal+=e.length;var r,n=this.resourceMap,o=this.loaderMap,s=this.loadDetailMap,c=Object(i["a"])(e);try{var l=function(){var e=r.value,i={url:e,progress:0,error:!1,message:e};if(s[e]=i,n.has(e))return i.progress=1,a.loadSuccess+=1,a.dispatchEvent({type:me.DETAILLOADED,detail:i}),a.dispatchEvent({type:me.LOADING,loadTotal:a.loadTotal,loadSuccess:a.loadSuccess,loadError:a.loadError}),a.checkLoaded(),"continue";var c=null==(t=e.split(".").pop())?void 0:t.toLocaleLowerCase();if(!c)return i.message="url: ".concat(e," 地址有误，无法获取文件格式。"),console.warn(i.message),i.error=!0,a.isError=!0,a.loadError+=1,a.dispatchEvent({type:me.DETAILLOADED,detail:i}),a.dispatchEvent({type:me.LOADING,loadTotal:a.loadTotal,loadSuccess:a.loadSuccess,loadError:a.loadError}),"continue";var l=o[c];if(!l)return i.message="url: ".concat(e," 不支持此文件格式加载。"),console.warn(i.message),i.error=!0,a.isError=!0,a.loadError+=1,a.dispatchEvent({type:me.DETAILLOADED,detail:i}),a.dispatchEvent({type:me.LOADING,loadTotal:a.loadTotal,loadSuccess:a.loadSuccess,loadError:a.loadError}),"continue";l.loadAsync(e,(function(e){i.progress=Number((e.loaded/e.total).toFixed(2)),a.dispatchEvent({type:me.DETAILLOADING,detail:i})})).then((function(t){i.progress=1,a.loadSuccess+=1,a.resourceMap.set(e,t),a.dispatchEvent({type:me.DETAILLOADED,detail:i}),a.dispatchEvent({type:me.LOADING,loadTotal:a.loadTotal,loadSuccess:a.loadSuccess,loadError:a.loadError}),a.checkLoaded()})).catch((function(e){i.error=!0,i.message=JSON.stringify(e),a.loadError+=1,a.dispatchEvent({type:me.DETAILLOADED,detail:i}),a.dispatchEvent({type:me.LOADING,loadTotal:a.loadTotal,loadSuccess:a.loadSuccess,loadError:a.loadError}),a.checkLoaded()}))};for(c.s();!(r=c.n()).done;)l()}catch(u){c.e(u)}finally{c.f()}return this}},{key:"reset",value:function(){return this.loadTotal=0,this.loadSuccess=0,this.loadError=0,this.isError=!1,this.isLoading=!1,this.isLoaded=!1,this.loadDetailMap={},this}},{key:"register",value:function(e,t){return this.loaderMap[e]=t,this}},{key:"hasLoaded",value:function(e){return this.resourceMap.has(e)}},{key:"getResource",value:function(e){return this.resourceMap.get(e)}},{key:"getLoadDetailMap",value:function(){return this.loadDetailMap}},{key:"setLoadDetailMap",value:function(e){return this.loadDetailMap=e,this}},{key:"toJSON",value:function(){var e=[];return this.resourceMap.forEach((function(t,a){e.push(a)})),JSON.stringify(e)}},{key:"dispose",value:function(){return this.resourceMap.clear(),this}}]),a}(w),Me=function(e){var t=this;if(this.loaderManager)return console.warn("engine has installed loaderManager plugin."),!1;var a=new je(e);return this.loaderManager=a,this.loadResources=function(e,a){var r=function e(r){a(void 0,r),t.loaderManager.removeEventListener("loaded",e)};try{t.loaderManager.addEventListener("loaded",r)}catch(n){a(n)}return t.loaderManager.load(e),t},this.loadResourcesAsync=function(e){return new Promise((function(a,r){var n=function e(r){a(r),t.loaderManager.removeEventListener("loaded",e)};try{t.loaderManager.addEventListener("loaded",n)}catch(i){r(i)}t.loaderManager.load(e)}))},!0};(function(e){e["BOXGEOMETRY"]="BoxGeometry",e["SPHEREGEOMETRY"]="SphereGeometry",e["LOADGEOMETRY"]="LoadGeometry",e["MODEL"]="Model",e["MESH"]="Mesh",e["LINE"]="Line",e["LINESEGMENTS"]="LineSegments",e["POINTS"]="Points",e["SPRITE"]="Sprite",e["IMAGETEXTURE"]="ImageTexture",e["CUBETEXTURE"]="CubeTexture",e["CANVASTEXTURE"]="CanvasTexture",e["MESHSTANDARDMATERIAL"]="MeshStandardMaterial",e["MESHPHONGMATERIAL"]="MeshPhongMaterial",e["SPRITEMATERIAL"]="SpriteMaterial",e["LINEBASICMATERIAL"]="LineBasicMaterial",e["POINTSMATERIAL"]="PointsMaterial",e["AMBIENTLIGHT"]="AmbientLight",e["SPOTLIGHT"]="SpotLight",e["POINTLIGHT"]="PointLight",e["PERSPECTIVECAMERA"]="PerspectiveCamera",e["ORTHOGRAPHICCAMERA"]="OrthographicCamera",e["WEBGLRENDERER"]="WebGLRenderer",e["SCENE"]="Scene",e["TRNASFORMCONTROLS"]="TransformControls",e["ORBITCONTROLS"]="OrbitControls",e["EVENT"]="Event"})(Oe||(Oe={})),function(e){e["CAMERA"]="camera",e["LIGHT"]="light",e["GEOMETRY"]="geometry",e["TEXTURE"]="texture",e["MATERIAL"]="material",e["RENDERER"]="renderer",e["SCENE"]="scene",e["SPRITE"]="sprite",e["CONTROLS"]="controls",e["EVENT"]="event",e["LINE"]="line",e["MESH"]="mesh",e["POINTS"]="points"}(ye||(ye={}));var Ee,we=function(){return{vid:"",type:"Object3D",castShadow:!0,receiveShadow:!0,lookAt:"",visible:!0,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}}},Ce=function(){return Object.assign(we(),{type:"Light",color:"rgb(255, 255, 255)",intensity:1})},Se=function(){return Object.assign(we(),{type:Oe.AMBIENTLIGHT,color:"rgb(255, 255, 255)",intensity:1})},Ae=function(){return Object.assign(Ce(),{type:Oe.POINTLIGHT,distance:30,decay:.01})},Le=function(){return Object.assign(Ce(),{type:Oe.SPOTLIGHT,distance:30,angle:Math.PI/180*45,penumbra:.01,decay:.01})},ke=function(){return{vid:"",type:"Geometry",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}}},Re=function(){return Object.assign(ke(),{type:"BoxGeometry",width:5,height:5,depth:5,widthSegments:1,heightSegments:1,depthSegments:1})},Te=function(){return Object.assign(ke(),{type:"SphereGeometry",radius:3,widthSegments:32,heightSegments:32,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI})},xe=function(){return Object.assign(ke(),{type:"LoadGeometry",url:""})},De=function(){return{vid:"",type:"Texture",name:"",mapping:m["zb"],wrapS:m["i"],wrapT:m["i"],magFilter:m["H"],minFilter:m["I"],anisotropy:1,format:m["ib"],offset:{x:0,y:0},repeat:{x:1,y:1},rotation:0,center:{x:0,y:0},matrixAutoUpdate:!0,encoding:m["G"],needsUpdate:!1}},Ie=function(){return Object.assign(De(),{type:"ImageTexture",url:""})},Pe=function(){return Object.assign(De(),{type:"CubeTexture",cube:{nx:"",ny:"",nz:"",px:"",py:"",pz:""}})},Ne=function(){return Object.assign(De(),{type:"CanvasTexture",url:"",needsUpdate:!1})},Ge=function(){return{vid:"",type:"Material",alphaTest:0,colorWrite:!0,depthTest:!0,depthWrite:!0,format:m["ib"],fog:!0,name:"",needsUpdate:!1,opacity:1,dithering:!1,shadowSide:null,side:m["y"],toneMapped:!0,transparent:!1,visible:!0}},He=function(){return Object.assign(Ge(),{type:Oe.MESHSTANDARDMATERIAL,aoMapIntensity:1,bumpScale:1,color:"rgb(255, 255, 255)",displacementScale:1,displacementBias:0,emissive:"rgb(0, 0, 0)",emissiveIntensity:1,envMapIntensity:1,flatShading:!1,lightMapIntensity:1,metalness:0,normalMapType:m["vb"],refractionRatio:.98,roughness:1,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",roughnessMap:"",normalMap:"",metalnessMap:"",map:"",lightMap:"",envMap:"",emissiveMap:"",displacementMap:"",bumpMap:"",alphaMap:"",aoMap:""})},ze=function(){return Object.assign(Ge(),{type:Oe.MESHPHONGMATERIAL,aoMapIntensity:1,bumpScale:1,color:"rgb(255, 255, 255)",displacementScale:1,displacementBias:0,emissive:"rgb(0, 0, 0)",emissiveIntensity:1,envMapIntensity:1,flatShading:!1,lightMapIntensity:1,normalMapType:m["vb"],refractionRatio:.98,wireframe:!1,wireframeLinecap:"round",wireframeLinejoin:"round",specular:"rgb(17, 17, 17)",shininess:30,combine:m["T"],normalMap:"",map:"",lightMap:"",envMap:"",emissiveMap:"",displacementMap:"",bumpMap:"",alphaMap:"",aoMap:"",specularMap:""})},Ve=function(){return Object.assign(Ge(),{type:Oe.SPRITEMATERIAL,color:"rgb(255, 255, 255)",rotation:0,map:"",alphaMap:"",sizeAttenuation:!0})},Fe=function(){return Object.assign(Ge(),{type:Oe.LINEBASICMATERIAL,color:"rgb(255, 255, 255)",linecap:"round",linejoin:"round",linewidth:1})},Ue=function(){return Object.assign(Ge(),{type:Oe.POINTSMATERIAL,map:"",alphaMap:"",color:"rgb(255, 255, 255)",sizeAttenuation:!0,size:1})},Be=function(){return Object.assign(we(),{type:Oe.PERSPECTIVECAMERA,adaptiveWindow:!1,fov:45,aspect:1920/1080,near:5,far:50})},We=function(){return Object.assign(we(),{type:Oe.ORTHOGRAPHICCAMERA,adaptiveWindow:!1,left:120,right:120,top:67.5,bottom:67.5,near:5,far:50})},_e=function(){return{vid:"WebGLRenderer",type:"WebGLRenderer",clearColor:"rgba(0, 0, 0, 0)",outputEncoding:m["G"],physicallyCorrectLights:!1,shadowMap:{enabled:!1,autoUpdate:!0,type:m["Z"]},toneMapping:m["U"],toneMappingExposure:1,pixelRatio:window.devicePixelRatio,adaptiveCamera:!1,viewport:null,scissor:null,size:null}},Ye=function(){return{vid:"Scene",type:"Scene",background:"",environment:"",fog:null}},Je=function(){return{vid:"TransformControls",type:"TransformControls",axis:"XYZ",enabled:!0,mode:"translate",snapAllow:!1,rotationSnap:Math.PI/180*10,translationSnap:5,scaleSnap:.1,showX:!0,showY:!0,showZ:!0,size:1,space:"world"}},Xe=function(){return{vid:"OrbitControls",type:"OrbitControls",autoRotate:!1,autoRotateSpeed:2,enableDamping:!1,dampingFactor:.05}},Ke=function(){return Object.assign(we(),{type:"Sprite",material:"",center:{x:.5,y:.5}})},Ze=function(){return{vid:"",type:"Event",pointerdown:[],pointermove:[],pointerup:[],pointerenter:[],pointerleave:[],click:[]}},qe=function(){return Object.assign(we(),{type:Oe.MESH,geometry:"",material:""})},Qe=function(){return Object.assign(we(),{type:Oe.POINTS,geometry:"",material:""})},$e=function(){return Object.assign(we(),{type:Oe.LINE,geometry:"",material:""})};function et(e,t){return e in t}function tt(){var e;return e={},Object(n["a"])(e,Oe.IMAGETEXTURE,ye.TEXTURE),Object(n["a"])(e,Oe.CUBETEXTURE,ye.TEXTURE),Object(n["a"])(e,Oe.CANVASTEXTURE,ye.TEXTURE),Object(n["a"])(e,Oe.MESHSTANDARDMATERIAL,ye.MATERIAL),Object(n["a"])(e,Oe.MESHPHONGMATERIAL,ye.MATERIAL),Object(n["a"])(e,Oe.SPRITEMATERIAL,ye.MATERIAL),Object(n["a"])(e,Oe.LINEBASICMATERIAL,ye.MATERIAL),Object(n["a"])(e,Oe.POINTSMATERIAL,ye.MATERIAL),Object(n["a"])(e,Oe.AMBIENTLIGHT,ye.LIGHT),Object(n["a"])(e,Oe.SPOTLIGHT,ye.LIGHT),Object(n["a"])(e,Oe.POINTLIGHT,ye.LIGHT),Object(n["a"])(e,Oe.BOXGEOMETRY,ye.GEOMETRY),Object(n["a"])(e,Oe.SPHEREGEOMETRY,ye.GEOMETRY),Object(n["a"])(e,Oe.LOADGEOMETRY,ye.GEOMETRY),Object(n["a"])(e,Oe.SPRITE,ye.SPRITE),Object(n["a"])(e,Oe.LINE,ye.LINE),Object(n["a"])(e,Oe.MESH,ye.MESH),Object(n["a"])(e,Oe.POINTS,ye.POINTS),Object(n["a"])(e,Oe.PERSPECTIVECAMERA,ye.CAMERA),Object(n["a"])(e,Oe.ORTHOGRAPHICCAMERA,ye.CAMERA),Object(n["a"])(e,Oe.WEBGLRENDERER,ye.RENDERER),Object(n["a"])(e,Oe.SCENE,ye.SCENE),Object(n["a"])(e,Oe.TRNASFORMCONTROLS,ye.CONTROLS),Object(n["a"])(e,Oe.EVENT,ye.EVENT),e}function at(){var e;return e={},Object(n["a"])(e,Oe.IMAGETEXTURE,Ie),Object(n["a"])(e,Oe.CUBETEXTURE,Pe),Object(n["a"])(e,Oe.CANVASTEXTURE,Ne),Object(n["a"])(e,Oe.MESHSTANDARDMATERIAL,He),Object(n["a"])(e,Oe.MESHPHONGMATERIAL,ze),Object(n["a"])(e,Oe.SPRITEMATERIAL,Ve),Object(n["a"])(e,Oe.LINEBASICMATERIAL,Fe),Object(n["a"])(e,Oe.POINTSMATERIAL,Ue),Object(n["a"])(e,Oe.AMBIENTLIGHT,Se),Object(n["a"])(e,Oe.SPOTLIGHT,Le),Object(n["a"])(e,Oe.POINTLIGHT,Ae),Object(n["a"])(e,Oe.BOXGEOMETRY,Re),Object(n["a"])(e,Oe.SPHEREGEOMETRY,Te),Object(n["a"])(e,Oe.LOADGEOMETRY,xe),Object(n["a"])(e,Oe.SPRITE,Ke),Object(n["a"])(e,Oe.LINE,$e),Object(n["a"])(e,Oe.MESH,qe),Object(n["a"])(e,Oe.POINTS,Qe),Object(n["a"])(e,Oe.PERSPECTIVECAMERA,Be),Object(n["a"])(e,Oe.ORTHOGRAPHICCAMERA,We),Object(n["a"])(e,Oe.WEBGLRENDERER,_e),Object(n["a"])(e,Oe.SCENE,Ye),Object(n["a"])(e,Oe.TRNASFORMCONTROLS,Je),Object(n["a"])(e,Oe.ORBITCONTROLS,Xe),Object(n["a"])(e,Oe.EVENT,Ze),e}var rt=new Uint8Array(16);function nt(){if(!Ee&&(Ee="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!Ee))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ee(rt)}var it=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ot(e){return"string"===typeof e&&it.test(e)}for(var st=[],ct=0;ct<256;++ct)st.push((ct+256).toString(16).substr(1));function lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(st[e[t+0]]+st[e[t+1]]+st[e[t+2]]+st[e[t+3]]+"-"+st[e[t+4]]+st[e[t+5]]+"-"+st[e[t+6]]+st[e[t+7]]+"-"+st[e[t+8]]+st[e[t+9]]+"-"+st[e[t+10]]+st[e[t+11]]+st[e[t+12]]+st[e[t+13]]+st[e[t+14]]+st[e[t+15]]).toLowerCase();if(!ot(a))throw TypeError("Stringified UUID is invalid");return a}function ut(e,t,a){e=e||{};var r=e.random||(e.rng||nt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){a=a||0;for(var n=0;n<16;++n)t[a+n]=r[n];return t}return lt(r)}var ht,pt=at(),dt=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(pt[e]){var n=function t(n,i){for(var o in i)void 0!==n[o]?"object"!==Object(f["a"])(i[o])||null===i[o]||Array.isArray(i[o])?n[o]=i[o]:t(n[o],i[o]):(!a&&(n[o]=i[o]),a&&r&&console.warn("'".concat(e,"' config can not set key: ").concat(o)))},i=pt[e]();return""===i.vid&&(i.vid=ut()),t&&n(i,t),i}return console.error("type: ".concat(e," can not be found in configList.")),null};(function(e){e["MAPPED"]="mapped"})(ht||(ht={}));var ft=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.call(this),E(Object(c["a"])(e),"structureMap",new Map),E(Object(c["a"])(e),"configMap",new Map),E(Object(c["a"])(e),"resourceMap",new Map),e}return Object(d["a"])(a,[{key:"mappingResource",value:function(e){var t=this.structureMap,a=this.configMap,r=this.resourceMap,n=function e(t,n){var i={type:"".concat(n.type)},o="";if(n.geometry){var s=n.geometry;s.computeBoundingBox();var c=s.boundingBox,l=c.getCenter(new m["Cb"]);o="".concat(t,".geometry"),r.set(o,s),a.set(o,dt(Oe.LOADGEOMETRY,{url:o,position:{x:l.x/(c.max.x-c.min.x)*2,y:l.y/(c.max.y-c.min.y)*2,z:l.z/(c.max.z-c.min.z)*2}})),i.geometry=o}if(n.material){var u=n.material;u instanceof Array?(i.material=[],u.forEach((function(e,n,s){o="".concat(t,".material.").concat(n),r.set(o,e),a.set(o,dt(e.type,e,!0,!1)),i.material[n]=o}))):(o="".concat(t,".material"),r.set(o,u),a.set(o,dt(u.type,u,!0,!1)),i.material=o)}return n.children.length&&(i.children=[],n.children.forEach((function(a,r,n){o="".concat(t,".children.").concat(r),i.children[r]=e(o,a)}))),i};return e.forEach((function(e,i){e instanceof HTMLImageElement?(r.set(i,e),a.set(i,dt(Oe.IMAGETEXTURE,{url:i})),t.set(i,i)):e instanceof HTMLCanvasElement?(r.set(i,e),t.set(i,i)):e instanceof m["V"]&&t.set(i,n(i,e))})),this.dispatchEvent({type:"mapped",structureMap:t,configMap:a,resourceMap:r}),this}},{key:"dispose",value:function(){}}]),a}(w),mt=function(e){var t=this;if(this.resourceManager)return console.warn("engine has installed resourceManager plugin."),!1;var a=new ft;return this.resourceManager=a,this.loaderManager&&this.loaderManager.addEventListener("loaded",(function(e){t.resourceManager.mappingResource(e.resourceMap)})),this.registerResources=function(e){var a=new Map;return Object.keys(e).forEach((function(t){a.set(t,e[t])})),t.resourceManager.mappingResource(a),t},!0},vt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){return Object(p["a"])(this,a),t.call(this)}return Object(d["a"])(a,[{key:"proxyExtends",value:function(e,t){var r=this;if(t||(t=[]),a.proxyWeakSet.has(e)||"object"!==Object(f["a"])(e)&&null!==e)return e;var n={get:function(e,t){return Reflect.get(e,t)},set:function(n,i,o){var s;if(void 0===n[i]){if("object"===Object(f["a"])(o)&&null!==o){var c=t.concat([i]);o=r.proxyExtends(o,c)}s=Reflect.set(n,i,o),r.broadcast({operate:"add",path:t.concat([]),key:i,value:o})}else{if("object"===Object(f["a"])(o)&&!a.proxyWeakSet.has(e)){var l=t.concat([i]);o=r.proxyExtends(o,l)}s=Reflect.set(n,i,o),r.broadcast({operate:"set",path:t.concat([]),key:i,value:o})}return s},deleteProperty:function(e,a){var n=Reflect.deleteProperty(e,a);return r.broadcast({operate:"delete",path:t.concat([]),key:a,value:""}),n}};if("object"===Object(f["a"])(e)&&null!==e)for(var i in e){var o=t.concat([i]);et(i,e)&&"object"===Object(f["a"])(e[i])&&null!==e[i]&&(e[i]=this.proxyExtends(e[i],o))}return new Proxy(e,n)}},{key:"broadcast",value:function(e){var t=e.operate,a=e.path,r=e.key,n=e.value,i={__poto__:!0,length:!0};return et(r,i)&&i[r]||this.dispatchEvent({type:"broadcast",notice:{operate:t,path:a,key:r,value:n}}),this}}]),a}(w),bt=vt;E(bt,"proxyWeakSet",new WeakSet);var gt=function(){function e(){Object(p["a"])(this,e),E(this,"rule"),E(this,"memberSet"),this.rule=function(){},this.memberSet=new Set}return Object(d["a"])(e,[{key:"apply",value:function(e){return this.memberSet.add(e),this}},{key:"cancel",value:function(e){return this.memberSet.delete(e),this}},{key:"setRule",value:function(e){return this.rule=e,this}},{key:"translate",value:function(e){var t=this.rule;return this.memberSet.forEach((function(a){t(e,a)})),this}}]),e}(),Ot=function(){function e(t,a){var r=this;Object(p["a"])(this,e),E(this,"data"),E(this,"broadcast"),E(this,"translater"),this.translater=(new gt).setRule(t),this.broadcast=new bt,this.data=this.broadcast.proxyExtends(a),this.broadcast.addEventListener("broadcast",(function(e){r.translater.translate(e.notice)}))}return Object(d["a"])(e,[{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){return this.data=e,this}},{key:"proxyData",value:function(e){return this.data=this.broadcast.proxyExtends(e),this.data}},{key:"addCompiler",value:function(e){return e.setTarget(this.data),e.compileAll(),this.translater.apply(e),this}},{key:"toJSON",value:function(){return JSON.stringify(this.data)}},{key:"load",value:function(e){var t=this.data;for(var a in e)t[a]=e[a];return this}}]),e}(),yt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"===a)ot(r)&&t.add(r,i);else if("set"===a){var o=n.concat([]),s=o.shift();if(!s||!ot(s))return void console.warn("texture rule vid is illeage: '".concat(s,"'"));t.set(s,o,r,i)}},jt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,yt,e)}return Object(d["a"])(a)}(Ot),Mt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"===a)ot(r)&&t.add(r,i);else if("set"===a){var o=n.concat([]),s=o.shift();if(!s||!ot(s))return void console.warn("material rule vid is illeage: '".concat(s,"'"));t.set(s,o,r,i)}},Et=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Mt,e)}return Object(d["a"])(a)}(Ot),wt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a)if("set"!==a);else{var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,r,i):console.warn("model rule vid is illeage: '".concat(s,"'"))}else ot(r)&&t.add(r,i)},Ct=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,wt,e)}return Object(d["a"])(a)}(Ot),St=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a)if("set"!==a);else{var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,i):console.warn("geometry rule vid is illeage: '".concat(s,"'"))}else ot(r)&&t.add(r,i)},At=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,St,e)}return Object(d["a"])(a)}(Ot),Lt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"===a)ot(r)&&t.add(r,i);else if("set"===a){var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,r,i):console.warn("camera rule vid is illeage: '".concat(s,"'"))}},kt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Lt,e)}return Object(d["a"])(a)}(Ot),Rt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;"add"!==a?"set"!==a||t.set(n.concat([]),r,i):t.add(r,i)},Tt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Rt,e)}return Object(d["a"])(a)}(Ot),xt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;"set"===a&&t.set(n.concat([]),r,i)},Dt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={scene:Ye()}),t.call(this,xt,e)}return Object(d["a"])(a)}(Ot),It=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("set"===a){var o=n.concat([]),s=o.shift();s?t.set(s,o,r,i):console.error("controls rule can not found controls type in set operate.")}},Pt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,It,e)}return Object(d["a"])(a)}(Ot),Nt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a){if("set"===a){var o=n.concat([]),s=o.shift();t.set(s,o,r,i)}}else t.add(r,i)},Gt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Nt,e)}return Object(d["a"])(a)}(Ot),Ht=function(e,t){var a=e.operate,r=e.key,n=(e.path,e.value);"add"!==a||ot(r)&&t.add(r,n)},zt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Ht,e)}return Object(d["a"])(a)}(Ot),Vt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a)if("set"!==a);else{var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,r,i):console.warn("model rule vid is illeage: '".concat(s,"'"))}else ot(r)&&t.add(r,i)},Ft=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Vt,e)}return Object(d["a"])(a)}(Ot),Ut=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a)if("set"!==a);else{var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,r,i):console.warn("model rule vid is illeage: '".concat(s,"'"))}else ot(r)&&t.add(r,i)},Bt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Ut,e)}return Object(d["a"])(a)}(Ot),Wt=function(e,t){var a=e.operate,r=e.key,n=e.path,i=e.value;if("add"!==a)if("set"!==a);else{var o=n.concat([]),s=o.shift();s&&ot(s)?t.set(s,o,r,i):console.warn("model rule vid is illeage: '".concat(s,"'"))}else ot(r)&&t.add(r,i)},_t=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){return Object(p["a"])(this,a),!e&&(e={}),t.call(this,Wt,e)}return Object(d["a"])(a)}(Ot),Yt=function(){function e(t){var a=this;Object(p["a"])(this,e),E(this,"cameraDataSupport"),E(this,"lightDataSupport"),E(this,"geometryDataSupport"),E(this,"textureDataSupport"),E(this,"materialDataSupport"),E(this,"rendererDataSupport"),E(this,"sceneDataSupport"),E(this,"controlsDataSupport"),E(this,"spriteDataSupport"),E(this,"eventDataSupport"),E(this,"lineDataSupport"),E(this,"meshDataSupport"),E(this,"pointsDataSupport"),E(this,"dataSupportMap"),this.cameraDataSupport=new kt,this.lightDataSupport=new Ct,this.geometryDataSupport=new At,this.textureDataSupport=new jt,this.materialDataSupport=new Et,this.rendererDataSupport=new Tt,this.sceneDataSupport=new Dt,this.controlsDataSupport=new Pt,this.spriteDataSupport=new Gt,this.eventDataSupport=new zt,this.lineDataSupport=new Ft,this.meshDataSupport=new Bt,this.pointsDataSupport=new _t,t&&Object.keys(t).forEach((function(e){void 0!==a[e]&&(a[e]=t[e])}));var r=new Map;for(var n in ye)r.set(ye[n],this["".concat(ye[n],"DataSupport")]);this.dataSupportMap=r}return Object(d["a"])(e,[{key:"getDataSupport",value:function(e){return this.dataSupportMap.has(e)?this.dataSupportMap.get(e):(console.warn("can not found this type in dataSupportManager: ".concat(e)),null)}},{key:"getSupportData",value:function(e){return this.dataSupportMap.has(e)?this.dataSupportMap.get(e).getData():(console.warn("can not found this type in dataSupportManager: ".concat(e)),null)}},{key:"setSupportData",value:function(e,t){return this.dataSupportMap.has(e)?this.dataSupportMap.get(e).setData(t):console.warn("can not found this type in dataSupportManager: ".concat(e)),this}},{key:"load",value:function(e){var t=this.dataSupportMap;return t.forEach((function(t,a){e[a]&&t.load(e[a])})),this}},{key:"toJSON",value:function(e){var t=e||{},a=this.dataSupportMap;return a.forEach((function(e,a){t[a]=e.getData()})),JSON.stringify(t)}}]),e}(),Jt=function(e){var t=this;if(this.dataSupportManager)return console.warn("engine has installed dataSupportManager plugin."),!1;var a=new Yt(e);return this.dataSupportManager=a,this.toJSON=function(){if(this.loaderManager){var e={assets:JSON.parse(this.loaderManager.toJSON())};return this.dataSupportManager.toJSON(e)}return this.dataSupportManager.toJSON()},this.completeSet.add((function(){var e=t.dataSupportManager.getDataSupport(ye.RENDERER).getData();e.WebGLRenderer||(e.WebGLRenderer=dt(Oe.WEBGLRENDERER));var a=t.dataSupportManager.getDataSupport(ye.SCENE).getData();a.scene||(a.scene=dt(Oe.SCENE));var r=t.dataSupportManager.getDataSupport(ye.CONTROLS).getData();t.transformControls&&(r[Oe.TRNASFORMCONTROLS]||(r[Oe.TRNASFORMCONTROLS]=dt(Oe.TRNASFORMCONTROLS))),t.orbitControls&&(r[Oe.ORBITCONTROLS]||(r[Oe.ORBITCONTROLS]=dt(Oe.ORBITCONTROLS)))})),!0},Xt=function(){function e(){Object(p["a"])(this,e)}return Object(d["a"])(e,null,[{key:"applyConfig",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,n=Object.assign({vid:!0,type:!0},a),i=function e(t,a){for(var r in t)n[r]||("object"===Object(f["a"])(t[r])&&null!==typeof t[r]&&et(r,a)?e(t[r],a[r]):et(r,a)&&(a[r]=t[r]))};i(e,t),r&&r()}}]),e}(),Kt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"IS_OBJECTCOMPILER",!0),E(Object(c["a"])(r),"scene"),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"map"),E(Object(c["a"])(r),"weakMap"),E(Object(c["a"])(r),"cacheObjectMap"),E(Object(c["a"])(r),"geometryMap"),E(Object(c["a"])(r),"materialMap"),E(Object(c["a"])(r),"objectMapSet"),e?(e.scene&&(r.scene=e.scene),e.target&&(r.target=e.target)):(r.scene=new m["lb"],r.target={}),r.geometryMap=new Map,r.materialMap=new Map,r.map=new Map,r.weakMap=new WeakMap,r.objectMapSet=new Set,r.cacheObjectMap=new WeakMap,r}return Object(d["a"])(a,[{key:"getMaterial",value:function(e){return ot(e)?this.materialMap.has(e)?this.materialMap.get(e):(console.warn("".concat(this.COMPILER_NAME,"Compiler: can not found material which vid: ").concat(e)),this.getReplaceMaterial()):(console.warn("".concat(this.COMPILER_NAME,"Compiler: material vid parameter is illegal: ").concat(e)),this.getReplaceMaterial())}},{key:"getGeometry",value:function(e){return ot(e)?this.geometryMap.has(e)?this.geometryMap.get(e):(console.warn("".concat(this.COMPILER_NAME,"Compiler: can not found geometry which vid: ").concat(e)),this.getReplaceGeometry()):(console.warn("".concat(this.COMPILER_NAME,"Compiler: geometry vid parameter is illegal: ").concat(e)),this.getReplaceGeometry())}},{key:"getObject",value:function(e){var t,a=Object(i["a"])(this.objectMapSet);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(r.has(e))return r.get(e)}}catch(n){a.e(n)}finally{a.f()}return null}},{key:"setLookAt",value:function(e,t){if(e===t)return console.error("can not set object lookAt itself."),this;if(!this.map.has(e))return console.error("".concat(this.COMPILER_NAME,"Compiler: can not found object which vid: ").concat(e,".")),this;var a=this.map.get(e),r=this.cacheObjectMap.get(a);if(r||(r={lookAtTarget:null,updateMatrixWorldFun:null},this.cacheObjectMap.set(a,r)),!t)return r.updateMatrixWorldFun?(a.updateMatrixWorld=r.updateMatrixWorldFun,r.lookAtTarget=null,r.updateMatrixWorldFun=null,this):this;var n=this.getObject(t);if(!n)return console.warn("".concat(this.COMPILER_NAME,"Compiler: can not found this vid mapping object: '").concat(e,"'")),this;var i=a.updateMatrixWorld;return r.updateMatrixWorldFun=i,r.lookAtTarget=n.position,a.updateMatrixWorld=function(e){i.bind(a)(e),a.lookAt(r.lookAtTarget)},this}},{key:"linkGeometryMap",value:function(e){return this.geometryMap=e,this}},{key:"linkMaterialMap",value:function(e){return this.materialMap=e,this}},{key:"linkObjectMap",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];for(var r=0,n=t;r<n.length;r++){var i=n[r];this.objectMapSet.has(i)||this.objectMapSet.add(i)}return this}},{key:"setScene",value:function(e){return this.scene=e,this}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"getMap",value:function(){return this.map}},{key:"getObjectSymbol",value:function(e){return this.weakMap.has(e)?this.weakMap.get(e):null}},{key:"compileAll",value:function(){var e=this.target;for(var t in e)this.add(t,e[t]);return this}},{key:"remove",value:function(e){return this.map.has(e)?(this.weakMap.delete(this.map.get(e)),this.cacheObjectMap.delete(this.map.get(e)),this.map.delete(e),this):(console.warn("".concat(this.COMPILER_NAME,"Compiler: can not found object which vid: ").concat(e,".")),this)}},{key:"dispose",value:function(){return this.map.clear(),this}}]),a}(Xt),Zt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"COMPILER_NAME",ye.CAMERA),E(Object(c["a"])(r),"engine"),E(Object(c["a"])(r),"constructMap"),E(Object(c["a"])(r),"filterAttribute"),E(Object(c["a"])(r),"cacheCameraMap"),E(Object(c["a"])(r),"replaceMaterial",new m["M"]),E(Object(c["a"])(r),"replaceGeometry",new m["e"]),e?e.engine&&(r.engine=e.engine):r.engine=(new ga).install(aa.WEBGLRENDERER);var n=new Map;return n.set("PerspectiveCamera",(function(){return new m["bb"]})),n.set("OrthographicCamera",(function(){return new m["Y"](0,0,0,0)})),r.constructMap=n,r.filterAttribute={scale:!0},r.cacheCameraMap=new WeakMap,r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return console.warn("CameraCompiler: can not use material in CameraCompiler."),this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return console.warn("CameraCompiler: can not use geometry in CameraCompiler."),this.replaceGeometry}},{key:"setAdaptiveWindow",value:function(e,t){if(!this.map.has(e))return console.warn("camera compiler can not found this vid camera: '".concat(e,"'")),this;var a=this.map.get(e),r=this.cacheCameraMap.get(a);if(r||(r={},this.cacheCameraMap.set(a,r)),!t){if(r.setSizeFun&&this.engine.hasEventListener("setSize",r.setSizeFun))return this.engine.removeEventListener("setSize",r.setSizeFun),r.setSizeFun=void 0,this;if(r.setSizeFun&&!this.engine.hasEventListener("setSize",r.setSizeFun))return r.setSizeFun=void 0,this}if(t){if(r.setSizeFun&&this.engine.hasEventListener("setSize",r.setSizeFun))return this;if(r.setSizeFun&&!this.engine.hasEventListener("setSize",r.setSizeFun))return this.engine.addEventListener("setSize",r.setSizeFun),this;var n=function(e){};a instanceof m["bb"]?n=function(e){a.aspect=e.width/e.height,a.updateProjectionMatrix()}:a instanceof m["Y"]?n=function(e){var t=e.width,r=e.height;a.left=-t/16,a.right=t/16,a.top=r/16,a.bottom=-r/16}:console.warn("camera compiler can not support this class camera:",a),this.engine.addEventListener("setSize",n),r.setSizeFun=n;var i=this.engine.webGLRenderer.domElement;n({type:"setSize",width:i.offsetWidth,height:i.offsetHeight})}return this}},{key:"add",value:function(e,t){if(t.type&&this.constructMap.has(t.type)){var a=this.constructMap.get(t.type)();Xt.applyConfig(t,a,Object.assign({lookAt:!0,adaptiveWindow:!0},this.filterAttribute)),(a instanceof m["bb"]||a instanceof m["Y"])&&a.updateProjectionMatrix(),this.map.set(e,a),this.weakMap.set(a,e),this.setLookAt(t.vid,t.lookAt),this.setAdaptiveWindow(t.vid,t.adaptiveWindow),this.scene.add(a)}else console.warn("CameraCompiler: can not support this config type: ".concat(t.type));return this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("geometry compiler set function can not found vid geometry: '".concat(e,"'")),this;if(this.filterAttribute[a])return this;if("lookAt"===a)return this.setLookAt(e,r);if("adaptiveWindow"===a)return this.setAdaptiveWindow(e,r);var n,o=this.map.get(e),s=Object(i["a"])(t);try{for(s.s();!(n=s.n()).done;){var c=n.value;if(this.filterAttribute[c])return this;o=o[c]}}catch(l){s.e(l)}finally{s.f()}return o[a]=r,(o instanceof m["bb"]||o instanceof m["Y"])&&o.updateProjectionMatrix(),this}},{key:"setEngine",value:function(e){return this.engine=e,this}},{key:"dispose",value:function(){return Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),qt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"transformControls"),e?(e.target&&(r.target=e.target),e.transformControls&&(r.transformControls=e.transformControls)):(r.target={TransformControls:Je()},r.transformControls=new y["a"](new m["f"])),r}return Object(d["a"])(a,[{key:"set",value:function(e,t,a,r){if("TransformControls"!==e)return console.warn("controls compiler can not support this controls: '".concat(e,"'")),this;var n=this.transformControls;if("snapAllow"===a){var i=this.target["TransformControls"];return r?(n.translationSnap=i.translationSnap,n.rotationSnap=i.rotationSnap,n.scaleSnap=i.scaleSnap):(n.translationSnap=null,n.rotationSnap=null,n.scaleSnap=null),this}return n[a]=r,this}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){return this}},{key:"dispose",value:function(e){return this}}]),a}(Xt),Qt=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),r.target=e?e.target:{},r}return Object(d["a"])(a,[{key:"add",value:function(e,t){return this}},{key:"remove",value:function(){return this}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this.target;for(var t in e)this.add(t,e[t]);return this}},{key:"dispose",value:function(){return this}}]),a}(Xt),$t=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"type","LoadBufferGeometry"),e&&r.copy(e),r}return Object(d["a"])(a)}(m["e"]),ea=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"map"),E(Object(c["a"])(r),"constructMap"),E(Object(c["a"])(r),"resourceMap"),E(Object(c["a"])(r),"replaceGeometry"),r.target=e.target,r.map=new Map;var n=new Map;return n.set("BoxGeometry",(function(e){return a.transfromAnchor(new m["c"](e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments),e)})),n.set("SphereGeometry",(function(e){return a.transfromAnchor(new m["ob"](e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength),e)})),n.set("LoadGeometry",(function(e){return a.transfromAnchor(new $t(r.getRescource(e.url)),e)})),r.constructMap=n,r.resourceMap=new Map,r.replaceGeometry=new m["c"](10,10,10),r}return Object(d["a"])(a,[{key:"linkRescourceMap",value:function(e){return this.resourceMap=e,this}},{key:"getRescource",value:function(e){if(!this.resourceMap.has(e))return console.error("rescoure can not found url: ".concat(e)),this.replaceGeometry.clone();if(this.resourceMap.has(e)&&this.resourceMap.get(e)instanceof m["e"]){var t=this.resourceMap.get(e);return t.clone()}return console.error("url mapping rescource is not class with BufferGeometry: ".concat(e)),this.replaceGeometry.clone()}},{key:"getMap",value:function(){return this.map}},{key:"setTarget",value:function(){return this}},{key:"add",value:function(e,t){if(ot(e)){if(t.type&&this.constructMap.has(t.type)){var a=this.constructMap.get(t.type)(t);this.map.set(e,a)}}else console.error("geometry vid parameter is illegal: ".concat(e));return this}},{key:"set",value:function(e,t,a){if(!ot(e))return console.warn("geometry compiler set function vid parameters is illeage: '".concat(e,"'")),this;if(!this.map.has(e))return console.warn("geometry compiler set function can not found vid geometry: '".concat(e,"'")),this;var r=this.map.get(e),n=this.target[e],i=this.constructMap.get(n.type)(n);return r.copy(i),r.uuid=i.uuid,i.dispose(),this}},{key:"compileAll",value:function(){var e=this.target;for(var t in e)this.add(t,e[t]);return this}},{key:"dispose",value:function(){return this.map.forEach((function(e,t){e.dispose()})),this}}]),a}(Xt),ta=ea;E(ta,"transfromAnchor",(function(e,t){e.center(),!e.boundingBox&&e.computeBoundingBox();var a=e.boundingBox,r=t.position,n=t.rotation,i=t.scale,o=new m["N"],s=new m["Cb"]((a.max.x-a.min.x)/2*r.x,(a.max.y-a.min.y)/2*r.y,(a.max.z-a.min.z)/2*r.z),c=(new m["hb"]).setFromEuler(new m["s"](n.x,n.y,n.z,"XYZ")),l=new m["Cb"](i.x,i.y,i.z);return o.compose(s,c,l),e.applyMatrix4(o),e}));var aa,ra=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"COMPILER_NAME",ye.LIGHT),E(Object(c["a"])(r),"constructMap"),E(Object(c["a"])(r),"filterAttribute"),E(Object(c["a"])(r),"replaceMaterial",new m["M"]),E(Object(c["a"])(r),"replaceGeometry",new m["e"]),r.constructMap=new Map,r.constructMap.set("PointLight",(function(){return new m["eb"]})),r.constructMap.set("SpotLight",(function(){return new m["rb"]})),r.constructMap.set("AmbientLight",(function(){return new m["a"]})),r.setLookAt=function(e,t){return this},r.filterAttribute={scale:!0,rotation:!0,lookAt:!0},r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return console.warn("LightCompiler: can not use material in LightCompiler."),this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return console.warn("LightCompiler: can not use geometry in LightCompiler."),this.replaceGeometry}},{key:"add",value:function(e,t){if(t.type&&this.constructMap.has(t.type)){var a=this.constructMap.get(t.type)();Xt.applyConfig(t,a,this.filterAttribute),a.color=new m["k"](t.color),this.map.set(e,a),this.weakMap.set(a,e),this.scene.add(a)}else console.warn("LightCompiler: can not support Light type: ".concat(t.type,"."));return this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("LightCompiler: can not found this vid mapping object: '".concat(e,"'")),this;if(this.filterAttribute[a])return this;var n,o=this.map.get(e),s=Object(i["a"])(t);try{for(s.s();!(n=s.n()).done;){var c=n.value;if(this.filterAttribute[c])return this;o=o[c]}}catch(l){s.e(l)}finally{s.f()}return o[a]=r,this}},{key:"dispose",value:function(){return Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),na=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"replaceMaterial",new m["E"]({color:"rgb(150, 150, 150)"})),E(Object(c["a"])(r),"replaceGeometry",new m["c"](10,10,10)),r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return this.replaceGeometry}},{key:"add",value:function(e,t){var a=new m["D"](this.getGeometry(t.geometry),this.getMaterial(t.material));return Xt.applyConfig(t,a,{geometry:!0,material:!0,lookAt:!0}),this.map.set(e,a),this.weakMap.set(a,e),this.setLookAt(e,t.lookAt),this.scene.add(a),this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("model compiler can not found this vid mapping object: '".concat(e,"'")),this;var n=this.map.get(e);if("lookAt"===a)return this.setLookAt(e,r);if("material"===a)return n.material=this.getMaterial(r),this;var o,s=Object(i["a"])(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;n=n[c]}}catch(l){s.e(l)}finally{s.f()}return n[a]=r,this}},{key:"dispose",value:function(){return Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),ia=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"map"),E(Object(c["a"])(r),"constructMap"),E(Object(c["a"])(r),"mapAttribute"),E(Object(c["a"])(r),"colorAttribute"),E(Object(c["a"])(r),"texturelMap"),E(Object(c["a"])(r),"resourceMap"),E(Object(c["a"])(r),"cachaColor"),e?e.target&&(r.target=e.target):r.target={},r.map=new Map,r.texturelMap=new Map,r.resourceMap=new Map,r.cachaColor=new m["k"];var n=new Map;return n.set(Oe.MESHSTANDARDMATERIAL,(function(){return new m["S"]})),n.set(Oe.MESHPHONGMATERIAL,(function(){return new m["R"]})),n.set(Oe.SPRITEMATERIAL,(function(){return new m["tb"]})),n.set(Oe.LINEBASICMATERIAL,(function(){return new m["E"]})),n.set(Oe.POINTSMATERIAL,(function(){return new m["gb"]})),r.constructMap=n,r.colorAttribute={color:!0,emissive:!0},r.mapAttribute={roughnessMap:!0,normalMap:!0,metalnessMap:!0,map:!0,lightMap:!0,envMap:!0,emissiveMap:!0,displacementMap:!0,bumpMap:!0,alphaMap:!0,aoMap:!0,specularMap:!0},r}return Object(d["a"])(a,[{key:"getTexture",value:function(e){if(this.texturelMap.has(e)){var t=this.texturelMap.get(e);return t instanceof m["wb"]?t:(console.error("this object which mapped by vid is not instance of Texture: ".concat(e)),null)}return console.error("texture map can not found this vid: ".concat(e)),null}},{key:"linkRescourceMap",value:function(e){return this.resourceMap=e,this}},{key:"linkTextureMap",value:function(e){return this.texturelMap=e,this}},{key:"add",value:function(e,t){if(ot(e))if(t.type&&this.constructMap.has(t.type)){var a=this.constructMap.get(t.type)(),r=JSON.parse(JSON.stringify(t)),n={},i=this.colorAttribute;for(var o in i)r[o]&&(a[o]=new m["k"](r[o]),n[o]=!0);var s=this.mapAttribute;for(var c in s)r[c]&&(a[c]=this.getTexture(r[c]),n[c]=!0);Xt.applyConfig(t,a,n),a.needsUpdate=!0,this.map.set(e,a)}else console.warn("material compiler can not support this type: ".concat(t.type));else console.error("material vid parameter is illegal: ".concat(e));return this}},{key:"set",value:function(e,t,a,r){if(!ot(e))return console.warn("material compiler set function: vid is illeage: '".concat(e,"'")),this;if(!this.map.has(e))return console.warn("material compiler set function: can not found material which vid is: '".concat(e,"'")),this;var n=this.map.get(e);if(this.colorAttribute[a])return n[a]=new m["k"](r),this;if(this.mapAttribute[a])return n[a]=this.getTexture(r),n.needsUpdate=!0,this;var i=n;return t.forEach((function(e,t,a){i=i[e]})),i[a]=r,this}},{key:"getMap",value:function(){return this.map}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this.target;for(var t in e)this.add(t,e[t]);return this}},{key:"dispose",value:function(){return this.map.forEach((function(e,t){e.dispose()})),this}}]),a}(Xt),oa=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"COMPILER_NAME",ye.MESH),E(Object(c["a"])(r),"replaceMaterial",new m["P"]({color:"rgb(150, 150, 150)"})),E(Object(c["a"])(r),"replaceGeometry",new m["c"](10,10,10)),r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return this.replaceGeometry}},{key:"add",value:function(e,t){var a=new m["O"](this.getGeometry(t.geometry),this.getMaterial(t.material));return Xt.applyConfig(t,a,{geometry:!0,material:!0,lookAt:!0}),this.map.set(e,a),this.weakMap.set(a,e),this.setLookAt(e,t.lookAt),this.scene.add(a),this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("model compiler can not found this vid mapping object: '".concat(e,"'")),this;var n=this.map.get(e);if("lookAt"===a)return this.setLookAt(e,r);if("material"===a)return n.material=this.getMaterial(r),this;var o,s=Object(i["a"])(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;n=n[c]}}catch(l){s.e(l)}finally{s.f()}return n[a]=r,this}},{key:"dispose",value:function(){return Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),sa=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"replaceMaterial",new m["gb"]({color:"rgb(150, 150, 150)"})),E(Object(c["a"])(r),"replaceGeometry",new m["p"](5)),r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return this.replaceGeometry}},{key:"add",value:function(e,t){var a=new m["fb"](this.getGeometry(t.geometry),this.getMaterial(t.material));return Xt.applyConfig(t,a,{geometry:!0,material:!0,lookAt:!0}),this.map.set(e,a),this.weakMap.set(a,e),this.setLookAt(e,t.lookAt),this.scene.add(a),this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("PointsCompiler: can not found this vid mapping object: '".concat(e,"'")),this;var n=this.map.get(e);if("lookAt"===a)return this.setLookAt(e,r);if("material"===a)return n.material=this.getMaterial(r),this;var o,s=Object(i["a"])(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;n=n[c]}}catch(l){s.e(l)}finally{s.f()}return n[a]=r,this}},{key:"dispose",value:function(){return Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),ca=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"renderer"),E(Object(c["a"])(r),"engine"),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"rendererCacheData"),r.engine=e.engine,r.target=e.target,r.renderer=r.engine.webGLRenderer,r.rendererCacheData={},r}return Object(d["a"])(a,[{key:"setClearColor",value:function(e){var t=Number(e.slice(0,-1).split(",").pop().trim());return this.renderer.setClearColor(e,t),this.renderer.clear(),this}},{key:"setPixelRatio",value:function(e){return this.renderer.setPixelRatio(e),this.renderer.clear(),this}},{key:"setSize",value:function(e){var t=this.renderer;if(e)t.setSize(e.x,e.y);else{var a=t.domElement;t.setSize(a.offsetWidth,a.offsetHeight)}return this}},{key:"setViewpoint",value:function(e){var t=this.renderer;if(e)t.setViewport(e.x,e.y,e.width,e.height);else{var a=t.domElement;t.setViewport(0,0,a.offsetWidth,a.offsetHeight)}return this}},{key:"setScissor",value:function(e){var t=this.renderer;if(e)t.setScissorTest(!0),t.setScissor(e.x,e.y,e.width,e.height);else{t.setScissorTest(!1);var a=t.domElement;t.setScissor(0,0,a.offsetWidth,a.offsetHeight)}return this}},{key:"setAdaptiveCamera",value:function(e){if(!this.engine)return console.warn("renderer compiler is not set engine."),this;var t=this.renderer,a=this.engine,r=a.renderManager;if(!e){if(!this.rendererCacheData.adaptiveCameraFun)return this;if(this.rendererCacheData.adaptiveCameraFun)return r.removeEventListener("render",this.rendererCacheData.adaptiveCameraFun),this.rendererCacheData.adaptiveCameraFun=void 0,this}if(e){if(this.rendererCacheData.adaptiveCameraFun)return r.addEventListener("render",this.rendererCacheData.adaptiveCameraFun),this;var n=function(e){var r=a.currentCamera,n=t.domElement.offsetWidth,i=t.domElement.offsetHeight,o=0,s=0,c=0,l=0,u=0;if(r instanceof m["bb"])u=r.aspect;else{if(!(r instanceof m["Y"]))return void console.warn("renderer compiler can not support this camera",r);o=r.right-r.left,s=r.top-r.bottom,u=o/s}u>=1?(o=n,s=o/u,l=i/2-s/2):(s=i,o=s*u,c=n/2-o/2),t.setScissor(c,l,o,s),t.setViewport(c,l,o,s),t.setScissorTest(!0)};this.rendererCacheData.adaptiveCameraFun=n,r.addEventListener("render",this.rendererCacheData.adaptiveCameraFun)}return this}},{key:"set",value:function(e,t,a){var r=this,n={clearColor:function(){return r.setClearColor(a)},pixelRatio:function(){return r.setPixelRatio(a)},size:function(){return r.setSize(r.target.size)},viewport:function(){return r.setViewpoint(r.target.viewport)},scissor:function(){return r.setScissor(r.target.scissor)},adaptiveCamera:function(){return r.setAdaptiveCamera(a)}};if(n[e[0]||t])return n[e[0]||t](),this;var i=this.renderer;return e.forEach((function(e,t,a){i=i[e]})),i[t]=a,this.renderer.clear(),this}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this.target;this.setClearColor(e.clearColor),this.setPixelRatio(e.pixelRatio),this.setSize(e.size),this.setViewpoint(e.viewport),this.setScissor(e.scissor),this.setAdaptiveCamera(e.adaptiveCamera);var t=JSON.parse(JSON.stringify(e));return delete t.vid,delete t.type,delete t.clearColor,delete t.pixelRatio,delete t.size,delete t.viewport,delete t.scissor,delete t.adaptiveCamera,Xt.applyConfig(t,this.renderer),this.renderer.clear(),this}},{key:"dispose",value:function(){return this.renderer.dispose(),this}}]),a}(Xt),la=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"engine"),E(Object(c["a"])(r),"map"),e?(e.target&&(r.target=e.target),e.engine&&(r.engine=e.engine)):(r.target={},r.engine=new ga),r.map={},r}return Object(d["a"])(a,[{key:"add",value:function(e,t){if("WebGLRenderer"===e){var a=new ca({engine:this.engine,target:t});a.compileAll(),this.map[e]=a}}},{key:"set",value:function(e,t,a){var r=e.shift();return r?this.map[r]?(this.map[r].set(e,t,a),this):(console.warn("renderer compiler can not support this type: ".concat(r)),this):(this.map[t].setTarget(a).compileAll(),this)}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this,t=this.target;return Object.keys(t).forEach((function(a){e.add(a,t[a])})),this}},{key:"dispose",value:function(){return this}}]),a}(Xt),ua=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"textureMap"),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"scene"),E(Object(c["a"])(r),"fogCache"),e?(e.target&&(r.target=e.target),e.scene&&(r.scene=e.scene)):(r.target={scene:Ye()},r.scene=new m["lb"]),r.textureMap=new Map,r.fogCache=null,r}return Object(d["a"])(a,[{key:"background",value:function(e){e?ot(e)?this.textureMap.has(e)?this.scene.background=this.textureMap.get(e):console.warn("scene compiler can not found this vid texture : '".concat(e,"'")):this.scene.background=new m["k"](e):this.scene.background=null}},{key:"environment",value:function(e){e?ot(e)?this.textureMap.has(e)?this.scene.environment=this.textureMap.get(e):console.warn("scene compiler can not found this vid texture : '".concat(e,"'")):console.warn("this vid is illegal: '".concat(e,"'")):this.scene.environment=null}},{key:"fog",value:function(e){if(e)if("Fog"===e.type)if(this.fogCache instanceof m["w"]){var t=this.fogCache;t.color=new m["k"](e.color),t.near=e.near,t.far=e.far}else this.scene.fog=new m["w"](e.color,e.near,e.far),this.fogCache=this.scene.fog;else if("FogExp2"===e.type)if(this.fogCache instanceof m["x"]){var a=this.fogCache;a.color=new m["k"](e.color),a.density=e.density}else this.scene.fog=new m["x"](e.color,e.density),this.fogCache=this.scene.fog;else console.warn("scene compiler can not support this type fog:'".concat(e.type,"'"));else this.scene.fog=null}},{key:"linkTextureMap",value:function(e){return this.textureMap=e,this}},{key:"set",value:function(e,t,a){var r=this,n=e.shift();if("scene"===n){var i={background:function(){return r.background(a)},environment:function(){return r.environment(a)},fog:function(){return r.fog(r.target.scene.fog)}};return i[t]&&i[t](),this}return console.warn("scene compiler can not support this type: ".concat(n)),this}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this.target.scene;return this.background(e.background),this.environment(e.environment),this.fog(e.fog),this}},{key:"dispose",value:function(){return this}}]),a}(Xt),ha=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"COMPILER_NAME",ye.SPRITE),E(Object(c["a"])(r),"replaceMaterial",new m["tb"]({color:"rgb(150, 150, 150)"})),E(Object(c["a"])(r),"replaceGeometry",new m["cb"](10,10,10)),r}return Object(d["a"])(a,[{key:"getReplaceMaterial",value:function(){return this.replaceMaterial}},{key:"getReplaceGeometry",value:function(){return console.warn("SpriteCompiler: can not use geometry in SpriteCompiler."),this.replaceGeometry}},{key:"getSpriteMaterial",value:function(e){var t=this.getMaterial(e);return t instanceof m["tb"]?t:(console.warn("SpriteCompiler: sprite object can not support this type material: ".concat(t.type,", vid: ").concat(e,".")),this.getReplaceMaterial())}},{key:"add",value:function(e,t){var a=new m["sb"];return this.map.set(e,a),this.weakMap.set(a,e),a.material=this.getSpriteMaterial(t.material),a.center.set(t.center.x,t.center.y),Xt.applyConfig(t,a,{center:!0,material:!0}),this.scene.add(a),this}},{key:"set",value:function(e,t,a,r){if(!this.map.has(e))return console.warn("SpriteCompiler: can not found this vid mapping object: '".concat(e,"'")),this;var n=this.map.get(e);if("material"===a)return n.material=this.getSpriteMaterial(r),this;if("lookAt"===a)return this.setLookAt(e,r);var o,s=Object(i["a"])(t);try{for(s.s();!(o=s.n()).done;){var c=o.value;n=n[c]}}catch(l){s.e(l)}finally{s.f()}return n[a]=r,this}},{key:"dispose",value:function(){return this.map.forEach((function(e,t){e.geometry.dispose()})),Object(o["a"])(Object(s["a"])(a.prototype),"dispose",this).call(this),this.replaceGeometry.dispose(),this.replaceMaterial.dispose(),this}}]),a}(Kt),pa=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e,r,n,i,o,s,c,l,u,h){return Object(p["a"])(this,a),t.call(this,e,r,n,i,o,s,c,l,u,h)}return Object(d["a"])(a)}(m["wb"]),da=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"target"),E(Object(c["a"])(r),"map"),E(Object(c["a"])(r),"constructMap"),E(Object(c["a"])(r),"resourceMap"),e?e.target&&(r.target=e.target):r.target={},r.map=new Map,r.resourceMap=new Map;var n=new Map;return n.set(Oe.IMAGETEXTURE,(function(){return new pa})),n.set(Oe.CUBETEXTURE,(function(){return new m["l"]})),n.set(Oe.CANVASTEXTURE,(function(){return new m["h"](document.createElement("canvas"))})),r.constructMap=n,r}return Object(d["a"])(a,[{key:"getResource",value:function(e){var t=this.resourceMap;if(t.has(e)){var a=t.get(e);return a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?a:(console.error("this url mapping resource is not a texture image class: ".concat(e)),null)}return console.warn("resource can not font url: ".concat(e)),null}},{key:"linkRescourceMap",value:function(e){return this.resourceMap=e,this}},{key:"add",value:function(e,t){if(ot(e))if(t.type&&this.constructMap.has(t.type)){var a=this.constructMap.get(t.type)(),r=JSON.parse(JSON.stringify(t));if(delete r.type,delete r.vid,t.type===Oe.IMAGETEXTURE||t.type===Oe.CANVASTEXTURE)a.image=this.getResource(r.url),delete r.url;else if(t.type===Oe.CUBETEXTURE){var n=t.cube,i=[this.getResource(n.px),this.getResource(n.nx),this.getResource(n.py),this.getResource(n.ny),this.getResource(n.pz),this.getResource(n.nz)];a.image=i,delete r.cube}Xt.applyConfig(r,a),a.needsUpdate=!0,this.map.set(e,a)}else console.warn("texture compiler can not support this type: ".concat(t.type));else console.error("texture vid parameter is illegal: ".concat(e));return this}},{key:"set",value:function(e,t,a,r){if(!ot(e))return console.warn("texture compiler set function: vid is illeage: '".concat(e,"'")),this;if(!this.map.has(e))return console.warn("texture compiler set function: can not found texture which vid is: '".concat(e,"'")),this;var n=this.map.get(e);if("needsUpdate"===a){if(r){n.needsUpdate=!0;var i=this.target[e];i.needsUpdate=!1}return this}var o=n;return t.forEach((function(e,t,a){o=o[e]})),o[a]=r,n.needsUpdate=!0,this}},{key:"getMap",value:function(){return this.map}},{key:"setTarget",value:function(e){return this.target=e,this}},{key:"compileAll",value:function(){var e=this.target;for(var t in e)this.add(t,e[t]);return this}},{key:"dispose",value:function(){return this}}]),a}(Xt),fa=function(){function e(t){var a=this;Object(p["a"])(this,e),E(this,"cameraCompiler"),E(this,"lightCompiler"),E(this,"geometryCompiler"),E(this,"textureCompiler"),E(this,"materialCompiler"),E(this,"rendererCompiler"),E(this,"sceneCompiler"),E(this,"controlsCompiler"),E(this,"spriteCompiler"),E(this,"eventCompiler"),E(this,"lineCompiler"),E(this,"meshCompiler"),E(this,"pointsCompiler"),E(this,"objectCompilerList"),this.objectCompilerList=[],t&&Object.keys(t).forEach((function(e){a[e]=t[e],t[e].IS_OBJECTCOMPILER&&a.objectCompilerList.push(t[e])}))}return Object(d["a"])(e,[{key:"support",value:function(e){var t=e.dataSupportManager,a=t.textureDataSupport,r=t.materialDataSupport,n=t.cameraDataSupport,o=t.lightDataSupport,s=t.geometryDataSupport,c=t.rendererDataSupport,l=t.sceneDataSupport,u=t.controlsDataSupport,p=t.spriteDataSupport,d=t.eventDataSupport,f=t.lineDataSupport,m=t.meshDataSupport,v=t.pointsDataSupport,b=new da({target:a.getData()});this.textureCompiler=b;var g=new ia({target:r.getData()});this.materialCompiler=g;var O=new ta({target:s.getData()});this.geometryCompiler=O;var y=new Zt({target:n.getData(),scene:e.scene,engine:e});this.cameraCompiler=y,this.objectCompilerList.push(y);var j=new ra({scene:e.scene,target:o.getData()});this.lightCompiler=j,this.objectCompilerList.push(j);var M=new ha({target:p.getData(),scene:e.scene});this.spriteCompiler=M,this.objectCompilerList.push(M);var E=new na({target:f.getData(),scene:e.scene});this.lineCompiler=E,this.objectCompilerList.push(E);var w=new oa({target:m.getData(),scene:e.scene});this.meshCompiler=w,this.objectCompilerList.push(w);var C=new sa({target:v.getData(),scene:e.scene});this.pointsCompiler=C,this.objectCompilerList.push(C);var S=new la({target:c.getData(),engine:e});this.rendererCompiler=S;var A=new ua({target:l.getData(),scene:e.scene});this.sceneCompiler=A;var L=new qt({target:u.getData(),transformControls:e.transformControls});this.controlsCompiler=L;var k=new Qt({target:d.getData()});this.eventCompiler=k;var R=e.resourceManager;A.linkTextureMap(b.getMap()),g.linkTextureMap(b.getMap());var T,x=this.objectCompilerList.map((function(e){return e.getMap()})),D=Object(i["a"])(this.objectCompilerList);try{for(D.s();!(T=D.n()).done;){var I,P=T.value;(I=P.linkGeometryMap(O.getMap()).linkMaterialMap(g.getMap())).linkObjectMap.apply(I,Object(h["a"])(x))}}catch(N){D.e(N)}finally{D.f()}return b.linkRescourceMap(R.resourceMap),O.linkRescourceMap(R.resourceMap),a.addCompiler(b),r.addCompiler(g),n.addCompiler(y),o.addCompiler(j),s.addCompiler(O),c.addCompiler(S),l.addCompiler(A),u.addCompiler(L),p.addCompiler(M),f.addCompiler(E),m.addCompiler(w),v.addCompiler(C),this}},{key:"getObjectSymbol",value:function(e){var t,a=this.objectCompilerList,r=Object(i["a"])(a);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=n.getObjectSymbol(e);if(o)return o}}catch(s){r.e(s)}finally{r.f()}return null}},{key:"getMaterial",value:function(e){if(ot(e)){var t=this.materialCompiler;return t.getMap().get(e)}console.warn("compiler manager vid is illeage: ".concat(e))}},{key:"getTexture",value:function(e){if(ot(e)){var t=this.textureCompiler;return t.getMap().get(e)}console.warn("compiler manager vid is illeage: ".concat(e))}},{key:"getObject",value:function(e){}},{key:"getObjectCompilerList",value:function(){return this.objectCompilerList}},{key:"dispose",value:function(){return this.geometryCompiler.dispose(),this.materialCompiler.dispose(),this.lineCompiler.dispose(),this.spriteCompiler.dispose(),this}}]),e}(),ma=function(e){var t=this;if(this.compilerManager)return console.warn("engine has installed compilerManager plugin."),!1;var a=new fa;return this.compilerManager=a,this.addEventListener("dispose",(function(){t.compilerManager.dispose()})),this.completeSet.add((function(){var e;t.webGLRenderer?t.scene?t.renderManager?t.dataSupportManager?(null==(e=t.compilerManager)||e.support(t),t.eventManager&&a.getObjectCompilerList()):console.warn("must install dataSupportManager before compilerManager plugin."):console.warn("must install renderManager before compilerManager plugin."):console.warn("must install scene before compilerManager plugin."):console.warn("must install webGLRenderer before compilerManager plugin.")})),!0};(function(e){e["WEBGLRENDERER"]="WebGLRenderer",e["SCENE"]="Scene",e["MODELINGSCENE"]="ModelingScene",e["RENDERMANAGER"]="RenderManager",e["ORBITCONTROLS"]="OrbitControls",e["STATS"]="Stats",e["EFFECTCOMPOSER"]="EffectComposer",e["POINTERMANAGER"]="PointerManager",e["EVENTMANAGER"]="EventManager",e["TRANSFORMCONTROLS"]="TransformControls",e["LOADERMANAGER"]="LoaderManager",e["RESOURCEMANAGER"]="ResourceManager",e["DATASUPPORTMANAGER"]="DataSupportManager",e["COMPILERMANAGER"]="CompilerManager"})(aa||(aa={}));var va=new Map;va.set("WebGLRenderer",ne),va.set("Scene",B),va.set("ModelingScene",U),va.set("RenderManager",Y),va.set("OrbitControls",X),va.set("Stats",Z),va.set("EffectComposer",q),va.set("PointerManager",$),va.set("EventManager",te),va.set("TransformControls",re),va.set("LoaderManager",Me),va.set("ResourceManager",mt),va.set("DataSupportManager",Jt),va.set("CompilerManager",ma);var ba=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(p["a"])(this,a),e=t.call(this),E(Object(c["a"])(e),"completeSet"),E(Object(c["a"])(e),"dom"),E(Object(c["a"])(e),"webGLRenderer"),E(Object(c["a"])(e),"currentCamera"),E(Object(c["a"])(e),"scene"),E(Object(c["a"])(e),"orbitControls"),E(Object(c["a"])(e),"transformControls"),E(Object(c["a"])(e),"effectComposer"),E(Object(c["a"])(e),"renderManager"),E(Object(c["a"])(e),"pointerManager"),E(Object(c["a"])(e),"eventManager"),E(Object(c["a"])(e),"loaderManager"),E(Object(c["a"])(e),"resourceManager"),E(Object(c["a"])(e),"dataSupportManager"),E(Object(c["a"])(e),"compilerManager"),E(Object(c["a"])(e),"stats"),E(Object(c["a"])(e),"transing"),E(Object(c["a"])(e),"setSize"),E(Object(c["a"])(e),"setCamera"),E(Object(c["a"])(e),"setDom"),E(Object(c["a"])(e),"setStats"),E(Object(c["a"])(e),"setTransformControls"),E(Object(c["a"])(e),"loadResources"),E(Object(c["a"])(e),"loadResourcesAsync"),E(Object(c["a"])(e),"registerResources"),E(Object(c["a"])(e),"toJSON"),E(Object(c["a"])(e),"play"),E(Object(c["a"])(e),"stop"),E(Object(c["a"])(e),"render"),e.completeSet=new Set,e.render=function(){return console.warn("can not install some plugin"),this},e}return Object(d["a"])(a,[{key:"optimizeMemory",value:function(){var e=this;Object.keys(this).forEach((function(t){void 0===e[t]&&delete e[t]}))}},{key:"install",value:function(e,t){return a.pluginHandler.has(e)?a.pluginHandler.get(e).call(this,t):console.error("engine can not support ".concat(e," plugin.")),this}},{key:"complete",value:function(){var e=this;return this.completeSet.forEach((function(t){t(e)})),this.completeSet.clear(),this}},{key:"dispose",value:function(){return this.dispatchEvent({type:"dispose"}),this}}]),a}(w),ga=ba;E(ga,"pluginHandler",va),E(ga,"register",(function(e,t){ba.pluginHandler&&ba.pluginHandler.set(e,t)})),E(ga,"dispose",(function(){ba.pluginHandler=void 0}));var Oa,ya=function(){function e(){Object(p["a"])(this,e),E(this,"supportData"),E(this,"supportDataType")}return Object(d["a"])(e,[{key:"create",value:function(e){return e?(this.supportData={},this.supportDataType=e,this):(console.warn("you must give a module type in create params"),this)}},{key:"add",value:function(t){return this.supportData&&this.supportDataType?t.type?e.configModelMap[t.type]!==this.supportDataType?(console.warn("current generator create config which module is in: ".concat(this.supportDataType,", but you provide type is '").concat(t.type,"'")),this):(this.supportData[t.vid]=dt(t.type,t),this):(console.warn("config can not found attribute 'type'"),this):(console.warn("you must call 'create' method before the 'add' method"),this)}},{key:"get",value:function(){return this.supportDataType=void 0,this.supportData?this.supportData:{}}}]),e}(),ja=ya;E(ja,"configModelMap",tt()),function(e){e["ACTIVE"]="active",e["HOVER"]="hover"}(Oa||(Oa={}));var Ma=new m["eb"]("rgb(255, 255, 255)",.5,200,1);Ma.position.set(-30,5,20),Ma.castShadow=!0;var Ea=new m["O"](new m["c"](80,2,80),new m["S"]({color:"rgb(255, 255, 255)"}));Ea.position.set(0,-11,0),Ea.receiveShadow=!0,Ea.castShadow=!0;var wa=function(){function e(t){Object(p["a"])(this,e),E(this,"material"),E(this,"dom"),E(this,"renderer"),E(this,"scene"),E(this,"camera"),E(this,"object");var a=new m["Fb"]({antialias:!0,preserveDrawingBuffer:!0});a.setPixelRatio(window.devicePixelRatio),a.setClearColor("rgb(150, 150, 150)"),a.shadowMap.enabled=!0,a.shadowMap.type=m["ab"];var r=new m["lb"],n=new m["bb"](45,window.innerWidth/window.innerHeight,1,500);n.position.set(0,0,35),n.up.x=0,n.up.y=1,n.up.z=0,n.lookAt(new m["Cb"](0,0,0)),r.add(e.ambientLight),r.add(e.pointLight),r.add(e.plane),this.scene=r,this.renderer=a,this.camera=n,this.object=new m["V"],(null==t?void 0:t.material)&&this.setMaterial(t.material),(null==t?void 0:t.dom)&&this.setDom(t.dom)}return Object(d["a"])(e,[{key:"setMaterial",value:function(t){if(this.scene.remove(this.object),this.material=t,t.type.includes("Mesh"))this.object=new m["O"](e.geometry,t);else if(t.type.includes("Line"))this.object=new m["D"](e.geometry,t);else if(t.type.includes("Ponits"))this.object=new m["fb"](e.geometry,t);else{if(!t.type.includes("Sprite"))return console.warn("material displayer can not support this type material: '".concat(t.type,"'")),this;this.object=new m["sb"](t)}return this.object.castShadow=!0,this.object.receiveShadow=!0,this.scene.add(this.object),this}},{key:"setDom",value:function(e){return this.dom=e,this.setSize(),e.appendChild(this.renderer.domElement),this}},{key:"setSize",value:function(e,t){if(e&&t)this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t,!0);else{if(!this.dom)return console.warn("material displayer must set dom before setSize with empty parameters"),this;var a=this.dom;this.camera.aspect=a.offsetWidth/a.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(a.offsetWidth,a.offsetHeight,!0)}return this}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"dispose",value:function(){this.renderer.dispose()}}]),e}(),Ca=wa;E(Ca,"ambientLight",new m["a"]("rgb(255, 255, 255)",.7)),E(Ca,"pointLight",Ma),E(Ca,"geometry",new m["ob"](10,12,12)),E(Ca,"plane",Ea),E(Ca,"dispose",(function(){wa.geometry.dispose(),wa.plane.geometry.dispose()}));var Sa=function(){function e(t){Object(p["a"])(this,e),E(this,"dom"),E(this,"texture"),E(this,"renderer"),E(this,"scene"),E(this,"camera");var a=new m["Fb"]({antialias:!0,preserveDrawingBuffer:!0});a.setPixelRatio(window.devicePixelRatio),a.setClearColor("rgb(150, 150, 150)"),a.shadowMap.enabled=!0,a.shadowMap.type=m["ab"];var r=new m["lb"],n=new m["bb"](45,window.innerWidth/window.innerHeight,1,500);n.position.set(0,0,35),n.up.x=0,n.up.y=1,n.up.z=0,n.lookAt(new m["Cb"](0,0,0)),r.add(e.ambientLight),this.scene=r,this.renderer=a,this.camera=n,(null==t?void 0:t.texture)&&this.setTexture(t.texture),(null==t?void 0:t.dom)&&this.setDom(t.dom)}return Object(d["a"])(e,[{key:"setTexture",value:function(e){return this.scene.background=e,this}},{key:"setDom",value:function(e){return this.dom=e,this.setSize(),e.appendChild(this.renderer.domElement),this}},{key:"setSize",value:function(e,t){if(e&&t)this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t,!0);else{if(!this.dom)return console.warn("texture displayer must set dom before setSize with empty parameters"),this;var a=this.dom;this.camera.aspect=a.offsetWidth/a.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(a.offsetWidth,a.offsetHeight,!0)}return this}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"dispose",value:function(){this.renderer.dispose()}}]),e}(),Aa=Sa;E(Aa,"ambientLight",new m["a"]("rgb(255, 255, 255)",1));var La=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this),E(Object(c["a"])(r),"IS_ENGINESUPPORT",!0),r.install(aa.LOADERMANAGER).install(aa.RESOURCEMANAGER).install(aa.DATASUPPORTMANAGER,e).install(aa.COMPILERMANAGER),r}return Object(d["a"])(a,[{key:"loadConfig",value:function(e,t){var a=this,r=function(){var t=a.dataSupportManager;e.texture&&t.load({texture:e.texture}),e.material&&t.load({material:e.material}),delete e.texture,delete e.material,t.load(e)};if(e.assets&&e.assets.length){this.loaderManager.reset().load(e.assets);var n=function n(i){delete e.assets,r(),a.resourceManager.removeEventListener("mapped",n),t&&t(i)};this.resourceManager.addEventListener("mapped",n)}else r(),t&&t();return this}},{key:"loadConfigAsync",value:function(e){var t=this;return new Promise((function(a,r){var n=function(){var a=t.dataSupportManager;e.texture&&a.load({texture:e.texture}),e.material&&a.load({material:e.material}),delete e.texture,delete e.material,a.load(e)};if(e.assets&&e.assets.length){t.loaderManager.reset().load(e.assets);var i=function r(i){delete e.assets,n(),t.resourceManager.removeEventListener("mapped",r),a(i)};t.resourceManager.addEventListener("mapped",i)}else n(),a(void 0)}))}}]),a}(ga),ka=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(e){var r;return Object(p["a"])(this,a),r=t.call(this,e),E(Object(c["a"])(r),"IS_ENGINESUPPORT",!0),r.install(aa.WEBGLRENDERER,{antialias:!0,alpha:!0}).install(aa.MODELINGSCENE,{hasDefaultPerspectiveCamera:!0,hasDefaultOrthographicCamera:!0,hasAxesHelper:!0,hasGridHelper:!0,hasDisplayMode:!0,displayMode:"env"}).install(aa.RENDERMANAGER).install(aa.STATS).install(aa.EFFECTCOMPOSER,{WebGLMultisampleRenderTarget:!0}).install(aa.ORBITCONTROLS).install(aa.POINTERMANAGER).install(aa.EVENTMANAGER).install(aa.TRANSFORMCONTROLS).complete(),r}return Object(d["a"])(a)}(La)}}]);