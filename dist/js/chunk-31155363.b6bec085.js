(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31155363"],{"1c79":function(e,t,n){},"32f8":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"material-container"},[n("drag-plane",{attrs:{amount:2,width:"100%",height:e.height+"px",showDragsign:!1},scopedSlots:e._u([{key:"view1",fn:function(){return[n("div",{staticClass:"box-header"},[n("el-input",{attrs:{size:"mini","prefix-icon":"el-icon-search",placeholder:"材质筛选"}}),n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.addMaterial}},[n("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus-outline",type:"primary"}},[e._v(" 添加材质 ")]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.material,(function(t,a){return n("el-dropdown-item",{key:a,attrs:{command:t},domProps:{textContent:e._s(t.label)}})})),1)],1)],1),n("div",{staticClass:"box-container"},[n("div",{staticClass:"material-main"},e._l(e.materialList,(function(t,a){return n("div",{key:a,staticClass:"material-elem",on:{mousedown:function(){e.$store.commit("material/setCurrentMaterial",t.vid)}}},[n("div",{ref:t.vid,refInFor:!0,staticClass:"render-box",class:{active:e.currentMaterial.vid===t.vid},attrs:{draggable:"true",id:t.vid},on:{dragstart:function(n){return e.dragstart(n,t.vid)}}}),n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"删除",expression:"'删除'",modifiers:{top:!0}}],staticClass:"operate-box"},[n("vis-icon",{attrs:{code:"#iconshanchu"}})],1),n("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.vid,expression:"item.vid",modifiers:{bottom:!0}}],staticClass:"element-title",domProps:{textContent:e._s(t.vid)}})])})),0)])]},proxy:!0},{key:"view2",fn:function(){return[n("material-setting-module")]},proxy:!0}])})],1)},i=[],r=(n("a9e3"),n("ec26")),o=n("6fab"),s=n("35bb"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"materialSettingModule-container"},[e.config?n("collapse-layout",{attrs:{label:"材质",icon:"#iconcaizhishezhi",arrowPosition:"left"},scopedSlots:e._u([{key:"container",fn:function(){return[n("vis-controller-input",{attrs:{keyframe:!1,label:"类型",disabled:""},model:{value:e.config.label,callback:function(t){e.$set(e.config,"label",t)},expression:"config.label"}})]},proxy:!0}],null,!1,2045396974)}):e._e(),n(e.type,{tag:"components",attrs:{config:e.config}})],1)},l=[],d=(n("d3b7"),n("3ca3"),n("ddb0"),n("597a")),u=function(){return Promise.all([n.e("chunk-vendors~253ae210"),n.e("chunk-vendors~2a42e354"),n.e("chunk-vendors~690b702c"),n.e("chunk-vendors~fdc6512a"),n.e("chunk-40d6be3a")]).then(n.bind(null,"01fa"))},m=function(){return n.e("chunk-75277101").then(n.bind(null,"4e96"))},p={components:{collapseLayout:d["a"],MeshStandardMaterial:u,VisMeshPhysicalMaterial:m},computed:{config:function(){return this.$store.getters["material/currentMaterial"]},type:function(){var e;return null===(e=this.config)||void 0===e?void 0:e.type}},methods:{}},v=p,f=(n("4e9a"),n("2877")),h=Object(f["a"])(v,c,l,!1,null,"1538915e",null),g=h.exports,b=n("2209"),y={components:{dragPlane:o["a"],materialSettingModule:g},props:{height:{type:Number}},data:function(){return{material:[{icon:"#icondengpao",label:"标准网格材质",material:b["a"].MESHSTANDARDMATERIAL}],displayerMap:{},watchMap:{},timer:"",throttleTime:1e3/45,canMove:!0}},computed:{materialList:function(){return this.$store.getters["material/get"]},currentMaterial:function(){return this.$store.getters["material/currentMaterial"]}},methods:{dragstart:function(e,t){var n=this;e.preventDefault(),this.$store.commit("material/setDraggedMaterial",t);var a=e.target,i=a.getElementsByTagName("canvas");if(i.length>0){this.$store.commit("material/dragging",!0);var r=i[0],o=new Image;o.src=r.toDataURL("image/png"),o.style.position="fixed",o.style.zIndex=20,o.style.opacity=.6,document.body.appendChild(o);var s=function(e){n.canMove&&(n.canMove=!1,n.timer=setTimeout((function(){o.style.top="".concat(e.clientY+10,"px"),o.style.left="".concat(e.clientX+10,"px"),n.canMove=!0}),n.throttleTime))},c=function e(t){document.body.removeChild(o),document.body.removeEventListener("mousemove",s),document.body.removeEventListener("mouseup",e)};document.body.addEventListener("mousemove",s),document.body.addEventListener("mouseup",c)}else console.error("can not found canvas in this dom")},addMaterial:function(e){var t=this,n=Object(b["r"])(e.material,{vid:Object(r["a"])()});this.$store.commit("material/add",n),this.$store.commit("material/setCurrentMaterial",n.vid),this.$nextTick((function(){var e=n.vid;if(!t.$refs[e])return console.error("can not found this dom: '".concat(e,"'")),!1;var a=new b["i"]({dom:t.$refs[e][0],material:s["a"].compilerManager.getMaterial(e)});a.render(),t.displayerMap[e]=a,t.watchMap[e]=t.$watch((function(){return this.materialList[e]}),(function(n){t.displayerMap[e].render()}),{deep:!0})}))}}},M=y,w=(n("f798"),Object(f["a"])(M,a,i,!1,null,"1e3c64e2",null));t["default"]=w.exports},"4e9a":function(e,t,n){"use strict";n("e851")},e851:function(e,t,n){},f798:function(e,t,n){"use strict";n("1c79")}}]);