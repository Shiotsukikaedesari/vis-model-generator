(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98d0c8a8"],{"1c79":function(t,e,i){},"2fdd":function(t,e,i){"use strict";i("9305")},"32f8":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"material-container"},[i("drag-plane",{attrs:{amount:2,width:"100%",height:t.height+"px",showDragsign:!1},scopedSlots:t._u([{key:"view1",fn:function(){return[i("div",{staticClass:"box-header"},[i("el-input",{attrs:{size:"mini","prefix-icon":"el-icon-search",placeholder:"材质筛选"}}),i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.addMaterial}},[i("el-button",{attrs:{size:"mini",icon:"el-icon-circle-plus-outline",type:"primary"}},[t._v(" 添加材质 ")]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.material,(function(e,s){return i("el-dropdown-item",{key:s,attrs:{command:e},domProps:{textContent:t._s(e.label)}})})),1)],1)],1),i("div",{staticClass:"box-container"},[i("div",{staticClass:"material-main"},t._l(t.materialList,(function(e,s){return i("div",{key:s,staticClass:"material-elem",on:{mousedown:function(){t.$store.commit("material/setCurrentMaterial",e.vid)}}},[i("div",{ref:e.vid,refInFor:!0,staticClass:"render-box",class:{active:t.currentMaterial.vid===e.vid},attrs:{draggable:"true",id:e.vid},on:{dragstart:function(i){return t.dragstart(i,e.vid)}}}),i("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:"删除",expression:"'删除'",modifiers:{top:!0}}],staticClass:"operate-box"},[i("vis-icon",{attrs:{code:"#iconshanchu"}})],1),i("div",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.vid,expression:"item.vid",modifiers:{bottom:!0}}],staticClass:"element-title",domProps:{textContent:t._s(e.vid)}})])})),0)])]},proxy:!0},{key:"view2",fn:function(){return[i("material-setting-module")]},proxy:!0}])})],1)},o=[],a=(i("a9e3"),i("ec26")),n=i("6fab"),r=i("35bb"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"materialSettingModule-container"},[t.config?i("collapse-layout",{attrs:{label:"材质",icon:"#iconcaizhishezhi",arrowPosition:"left"},scopedSlots:t._u([{key:"container",fn:function(){return[i("vis-controller-input",{attrs:{keyframe:!1,label:"类型",disabled:""},model:{value:t.config.label,callback:function(e){t.$set(t.config,"label",e)},expression:"config.label"}})]},proxy:!0}],null,!1,2045396974)}):t._e(),i(t.type,{tag:"components",attrs:{config:t.config}})],1)},c=[],h=(i("d3b7"),i("3ca3"),i("ddb0"),i("597a")),d=function(){return i.e("chunk-40d6be3a").then(i.bind(null,"01fa"))},u=function(){return i.e("chunk-4e41bab0").then(i.bind(null,"4e96"))},f={components:{collapseLayout:h["a"],MeshStandardMaterial:d,VisMeshPhysicalMaterial:u},computed:{config:function(){return this.$store.getters["material/currentMaterial"]},type:function(){var t;return null===(t=this.config)||void 0===t?void 0:t.type}},methods:{}},p=f,g=(i("4e9a"),i("2877")),m=Object(g["a"])(p,l,c,!1,null,"1538915e",null),v=m.exports,b=i("fe9e"),x={components:{dragPlane:n["a"],materialSettingModule:v},props:{height:{type:Number}},data:function(){return{material:[{icon:"#icondengpao",label:"标准网格材质",material:b["a"].MESHSTANDARDMATERIAL}],displayerMap:{},watchMap:{},timer:"",throttleTime:1e3/45,canMove:!0}},computed:{materialList:function(){return this.$store.getters["material/get"]},currentMaterial:function(){return this.$store.getters["material/currentMaterial"]}},methods:{dragstart:function(t,e){var i=this;t.preventDefault(),this.$store.commit("material/setDraggedMaterial",e);var s=t.target,o=s.getElementsByTagName("canvas");if(o.length>0){this.$store.commit("material/dragging",!0);var a=o[0],n=new Image;n.src=a.toDataURL("image/png"),n.style.position="fixed",n.style.zIndex=20,n.style.opacity=.6,document.body.appendChild(n);var r=function(t){i.canMove&&(i.canMove=!1,i.timer=setTimeout((function(){n.style.top="".concat(t.clientY+10,"px"),n.style.left="".concat(t.clientX+10,"px"),i.canMove=!0}),i.throttleTime))},l=function t(e){document.body.removeChild(n),document.body.removeEventListener("mousemove",r),document.body.removeEventListener("mouseup",t)};document.body.addEventListener("mousemove",r),document.body.addEventListener("mouseup",l)}else console.error("can not found canvas in this dom")},addMaterial:function(t){var e=this,i=Object(b["r"])(t.material,{vid:Object(a["a"])()});this.$store.commit("material/add",i),this.$store.commit("material/setCurrentMaterial",i.vid),this.$nextTick((function(){var t=i.vid;if(!e.$refs[t])return console.error("can not found this dom: '".concat(t,"'")),!1;var s=new b["i"]({dom:e.$refs[t][0],material:r["a"].compilerManager.getMaterial(t)});s.render(),e.displayerMap[t]=s,e.watchMap[t]=e.$watch((function(){return this.materialList[t]}),(function(i){e.displayerMap[t].render()}),{deep:!0})}))}}},w=x,y=(i("f798"),Object(g["a"])(w,s,o,!1,null,"1e3c64e2",null));e["default"]=y.exports},"4e9a":function(t,e,i){"use strict";i("e851")},"597a":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"collapseLayout-container"},[i("div",{staticClass:"collapseLayout-title",on:{click:t.toggle}},["left"===t.arrowPosition?i("vis-icon",{class:{"icon-open":!t.showCollapse},staticStyle:{"margin-right":"5px"},attrs:{code:"#iconjian"}}):t._e(),i("div",{staticClass:"title-box"},[t.showIcon?i("vis-icon",{attrs:{code:t.icon}}):t._e(),i("span",{domProps:{textContent:t._s(t.label)}})],1),"right"===t.arrowPosition?i("vis-icon",{class:{"icon-open":!t.showCollapse},attrs:{code:"#iconjian"}}):t._e()],1),i("el-collapse-transition",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showCollapse,expression:"showCollapse"}],staticClass:"collapseLayout-main"},[t._t("container")],2)])],1)},o=[],a={name:"collapse-layout",props:{icon:{type:String,default:"#iconmoxing"},showIcon:{type:Boolean,default:!0},label:{type:String,default:"折叠面板布局"},fold:{type:Boolean,default:!1},arrowPosition:{type:String,default:"right"}},data:function(){return{showCollapse:!0}},watch:{fold:{handler:function(t){this.showCollapse=!t},immediate:!0}},methods:{toggle:function(){this.showCollapse=!this.showCollapse,this.$emit("change",this.showCollapse)}}},n=a,r=(i("2fdd"),i("2877")),l=Object(r["a"])(n,s,o,!1,null,"6aabd072",null);e["a"]=l.exports},"6fab":function(t,e,i){"use strict";i("a9e3"),i("fb6a");var s,o,a={name:"drag-plane",props:{height:{type:String,default:"500px"},width:{type:String,default:"300px"},direction:{type:String,default:"column"},amount:{type:Number,default:2},safeDistance:{type:Number,default:24},boxSaveDistance:{type:Number,default:100},showDragsign:{type:Boolean,default:!0},dragTop:{type:Boolean,default:!1},dragBottom:{type:Boolean,default:!1},dragLeft:{type:Boolean,default:!1},dragRight:{type:Boolean,default:!1}},data:function(){return{spaceData:{},showInnerMask:!1,showOutMask:!1,lineDirection:"",boxWidth:"",boxHight:"",mouseX:"",mouseY:"",touchNum:""}},render:function(t){var e=this,i={class:"dragFlexPanel-drag"},s={class:"dragFlexPanel-view"},o=t("div",{class:{"dragFlexPanel-line":!0,"dragFlexPanel-line-sign":this.showDragsign},style:"row"===this.direction?"height: 100%;width: 3px;right: 0;top: 0;":"width: 100%;height: 3px;left: 0;bottom: 0;",on:{mousedown:this.dragLineMouseDown}}),a=t("div",{attrs:{id:"drag".concat(this.amount),class:"".concat(i.class)},ref:"drag".concat(this.amount)},[t("div",{class:s.class},[this.$slots["view1"]]),o]),n=function n(r){if(r===e.amount)return a;var l=t("div",{attrs:{class:s.class}},e.$slots["view".concat(e.amount-r+1)]);return t("div",{attrs:{id:"drag".concat(r),class:i.class,style:"flex-direction: ".concat(e.direction,";")},ref:"drag".concat(r)},[n(r+1),l,o])},r=t("div",{attrs:{class:"dragFlexPanel-mask-inner"},style:{display:this.showInnerMask?"block":"none"},on:{mousemove:this.innerMaskMouseMove,mouseup:this.innerMaskMouseUp,mouseleave:this.innerMaskMouseLeave},ref:"innerMask"}),l=t("div",{attrs:{class:"dragFlexPanel-mask-outer"},style:{display:this.showOutMask?"block":"none",cursor:"top"===this.lineDirection||"bottom"===this.lineDirection?"ns-resize":"ew-resize"},on:{mousemove:this.outerMaskMouseMove,mouseup:this.outerMaskMouseUp,mouseleave:this.outerMaskMouseLeave},ref:"outerMask"}),c=t("div",{attrs:{style:"top: 0;left: 0;width: 100%;cursor: ns-resize;"},style:{display:this.dragTop?"black":"none"},class:{"dragFlexPanel-boxLine":!0,"dragFlexPanel-boxLine-n":this.dragTop,"dragFlexPanel-boxLine-n-sign":this.dragTop&&this.showDragsign},ref:"boxLine-top",on:{mousedown:function(t){return e.boxLineMouseDown(t,"top")}}}),h=t("div",{attrs:{style:"bottom: 0;left: 0;width: 100%;cursor: ns-resize;"},style:{display:this.dragBottom?"black":"none"},class:{"dragFlexPanel-boxLine":!0,"dragFlexPanel-boxLine-s":this.dragBottom,"dragFlexPanel-boxLine-s-sign":this.dragBottom&&this.showDragsign},ref:"boxLine-bottom",on:{mousedown:function(t){return e.boxLineMouseDown(t,"bottom")}}}),d=t("div",{attrs:{style:"top: 0;left: 0;height: 100%;cursor: ew-resize;"},style:{display:this.dragLeft?"black":"none"},class:{"dragFlexPanel-boxLine":!0,"dragFlexPanel-boxLine-w":this.dragLeft,"dragFlexPanel-boxLine-w-sign":this.dragLeft&&this.showDragsign},ref:"boxLine-left",on:{mousedown:function(t){return e.boxLineMouseDown(t,"left")}}}),u=t("div",{attrs:{style:"top: 0;right: 0;height: 100%;cursor: ew-resize;"},style:{display:this.dragRight?"black":"none"},class:{"dragFlexPanel-boxLine":!0,"dragFlexPanel-boxLine-e":this.dragRight,"dragFlexPanel-boxLine-e-sign":this.dragRight&&this.showDragsign},ref:"boxLine-right",on:{mousedown:function(t){return e.boxLineMouseDown(t,"right")}}});return t("div",{attrs:{class:"dragFlexPanel-box"},style:{flexDriection:this.direction,width:this.boxWidth,height:this.boxHeight,borderTopWidth:this.dragTop?"":"1px",borderBottomWidth:this.dragBottom?"":"1px",borderLeftWidth:this.dragLeft?"":"1px",borderRightWidth:this.dragRight?"":"1px"},ref:"box"},[n(1),r,l,c,h,d,u])},methods:{setDistance:function(){var t=this.$refs.box.offsetHeight/this.amount;t||(t=parseInt(this.$refs.box.style.height)/this.amount);for(var e=2;e<=this.amount;e+=1){var i=t*(this.amount-e+1);this.$refs["drag".concat(e)].style.height="".concat(i,"px"),this.spaceData[e]=i}},dragLineMouseDown:function(t){t.preventDefault(),t.target.classList.add("dragFlexPanel-line-click"),this.touchNum=t.target.parentNode.id.slice(4),this.showInnerMask=!0},innerMaskMouseMove:function(t){if(t.preventDefault(),"row"===this.direction)this.$refs["drag".concat(this.touchNum)].style.height=t.offsetX;else{var e=t.offsetY,i=(this.spaceData[parseInt(this.touchNum)+1]||0)+this.safeDistance,s=(this.spaceData[parseInt(this.touchNum)-1]||this.$refs.box.offsetHeight)-this.safeDistance;this.$refs["drag".concat(this.touchNum)].style.height="".concat(e<=i?i:e>=s?s:e,"px"),this.spaceData[this.touchNum]=parseInt(this.$refs["drag".concat(this.touchNum)].style.height)}},innerMaskMouseLeave:function(t){t.preventDefault(),this.innerMaskMouseUp()},innerMaskMouseUp:function(t){this.showInnerMask=!1;var e=this.$refs["drag".concat(this.touchNum)].lastElementChild;e.classList.remove("dragFlexPanel-line-click")},boxLineMouseDown:function(t,e){t.preventDefault(),this.showOutMask=!0,this.mouseX=t.clientX,this.mouseY=t.clientY,this.lineDirection=e,this.$refs["boxLine-".concat(this.lineDirection)].classList.add("dragFlexPanel-boxLine-click")},outerMaskMouseMove:function(t){t.preventDefault();var e=t.clientX-this.mouseX,i=t.clientY-this.mouseY;if("top"===this.lineDirection||"bottom"===this.lineDirection){var s=parseFloat(this.boxHeight)+i;"column"===this.direction?s<=this.spaceData[2]+this.boxSaveDistance?this.$refs.box.style.height=this.spaceData[2]+this.boxSaveDistance:this.$refs.box.style.height="".concat(s,"px"):s<=this.boxSaveDistance?this.$refs.box.style.height=this.boxSaveDistance:this.$refs.box.style.height="".concat(s,"px")}else if("right"===this.lineDirection||"left"===this.lineDirection){var o=parseFloat(this.boxWidth)+e;"row"===this.direction||(o<=this.boxSaveDistance?this.$refs.box.style.width=this.boxSaveDistance:this.$refs.box.style.width="".concat(o,"px"))}},outerMaskMouseLeave:function(t){t.preventDefault(),this.outerMaskMouseUp()},outerMaskMouseUp:function(t){this.showOutMask=!1,this.boxWidth=this.$refs.box.style.width,this.boxHeight=this.$refs.box.style.height,this.$refs["boxLine-".concat(this.lineDirection)].classList.remove("dragFlexPanel-boxLine-click")}},watch:{height:function(t,e){this.boxHight=t},width:function(t,e){this.boxWidth=t}},created:function(){this.boxWidth=this.width,this.boxHeight=this.height},mounted:function(){this.setDistance()}},n=a,r=(i("f171"),i("2877")),l=Object(r["a"])(n,s,o,!1,null,null,null);e["a"]=l.exports},9305:function(t,e,i){},b19d:function(t,e,i){},e851:function(t,e,i){},f171:function(t,e,i){"use strict";i("b19d")},f798:function(t,e,i){"use strict";i("1c79")}}]);